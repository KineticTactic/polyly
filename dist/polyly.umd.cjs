(function(S,g){typeof exports=="object"&&typeof module<"u"?module.exports=g():typeof define=="function"&&define.amd?define(g):(S=typeof globalThis<"u"?globalThis:S||self,S.polyly=g())})(this,function(){"use strict";var Wi=Object.defineProperty;var qi=(S,g,N)=>g in S?Wi(S,g,{enumerable:!0,configurable:!0,writable:!0,value:N}):S[g]=N;var p=(S,g,N)=>(qi(S,typeof g!="symbol"?g+"":g,N),N);/* @license twgl.js 5.5.3 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */let S=Float32Array;function g(t){const e=S;return S=t,e}function N(t,e,n){const r=new S(3);return t&&(r[0]=t),e&&(r[1]=e),n&&(r[2]=n),r}function Yt(t,e,n){return n=n||new S(3),n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function Le(t,e,n){return n=n||new S(3),n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function Ht(t,e,n,r){return r=r||new S(3),r[0]=t[0]+n*(e[0]-t[0]),r[1]=t[1]+n*(e[1]-t[1]),r[2]=t[2]+n*(e[2]-t[2]),r}function Wt(t,e,n,r){return r=r||new S(3),r[0]=t[0]+n[0]*(e[0]-t[0]),r[1]=t[1]+n[1]*(e[1]-t[1]),r[2]=t[2]+n[2]*(e[2]-t[2]),r}function qt(t,e,n){return n=n||new S(3),n[0]=Math.max(t[0],e[0]),n[1]=Math.max(t[1],e[1]),n[2]=Math.max(t[2],e[2]),n}function Xt(t,e,n){return n=n||new S(3),n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.min(t[2],e[2]),n}function jt(t,e,n){return n=n||new S(3),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n}function Kt(t,e,n){return n=n||new S(3),n[0]=t[0]/e,n[1]=t[1]/e,n[2]=t[2]/e,n}function Se(t,e,n){n=n||new S(3);const r=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];return n[0]=t[1]*e[2]-t[2]*e[1],n[1]=r,n[2]=i,n}function Zt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Jt(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}function Qt(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function dt(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}function en(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function ee(t,e){e=e||new S(3);const n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=Math.sqrt(n);return r>1e-5?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=0,e[1]=0,e[2]=0),e}function tn(t,e){return e=e||new S(3),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function nn(t,e){return e=e||new S(3),e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function rn(t,e,n){return n=n||new S(3),n[0]=t[0]*e[0],n[1]=t[1]*e[1],n[2]=t[2]*e[2],n}function on(t,e,n){return n=n||new S(3),n[0]=t[0]/e[0],n[1]=t[1]/e[1],n[2]=t[2]/e[2],n}var cn=Object.freeze({__proto__:null,add:Yt,copy:nn,create:N,cross:Se,distance:dt,distanceSq:en,divide:on,divScalar:Kt,dot:Zt,lerp:Ht,lerpV:Wt,length:Jt,lengthSq:Qt,max:qt,min:Xt,mulScalar:jt,multiply:rn,negate:tn,normalize:ee,setDefaultType:g,subtract:Le});let b=Float32Array;function sn(t){const e=b;return b=t,e}function un(t,e){return e=e||new b(16),e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e}function fn(){return new b(16).fill(0)}function Oe(t,e){return e=e||new b(16),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ke(t){return t=t||new b(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function an(t,e){if(e=e||new b(16),e===t){let T;return T=t[1],t[1]=t[4],t[4]=T,T=t[2],t[2]=t[8],t[8]=T,T=t[3],t[3]=t[12],t[12]=T,T=t[6],t[6]=t[9],t[9]=T,T=t[7],t[7]=t[13],t[13]=T,T=t[11],t[11]=t[14],t[14]=T,e}const n=t[0*4+0],r=t[0*4+1],i=t[0*4+2],o=t[0*4+3],c=t[1*4+0],s=t[1*4+1],u=t[1*4+2],f=t[1*4+3],h=t[2*4+0],a=t[2*4+1],l=t[2*4+2],y=t[2*4+3],x=t[3*4+0],m=t[3*4+1],E=t[3*4+2],_=t[3*4+3];return e[0]=n,e[1]=c,e[2]=h,e[3]=x,e[4]=r,e[5]=s,e[6]=a,e[7]=m,e[8]=i,e[9]=u,e[10]=l,e[11]=E,e[12]=o,e[13]=f,e[14]=y,e[15]=_,e}function $e(t,e){e=e||new b(16);const n=t[0*4+0],r=t[0*4+1],i=t[0*4+2],o=t[0*4+3],c=t[1*4+0],s=t[1*4+1],u=t[1*4+2],f=t[1*4+3],h=t[2*4+0],a=t[2*4+1],l=t[2*4+2],y=t[2*4+3],x=t[3*4+0],m=t[3*4+1],E=t[3*4+2],_=t[3*4+3],T=l*_,I=E*y,M=u*_,R=E*f,D=u*y,P=l*f,v=i*_,C=E*o,V=i*y,L=l*o,O=i*f,k=u*o,$=h*m,G=x*a,Y=c*m,H=x*s,W=c*a,le=h*s,ye=n*m,xe=x*r,Ae=n*a,pe=h*r,Te=n*s,me=c*r,Ot=T*s+R*a+D*m-(I*s+M*a+P*m),kt=I*r+v*a+L*m-(T*r+C*a+V*m),$t=M*r+C*s+O*m-(R*r+v*s+k*m),Gt=P*r+V*s+k*a-(D*r+L*s+O*a),F=1/(n*Ot+c*kt+h*$t+x*Gt);return e[0]=F*Ot,e[1]=F*kt,e[2]=F*$t,e[3]=F*Gt,e[4]=F*(I*c+M*h+P*x-(T*c+R*h+D*x)),e[5]=F*(T*n+C*h+V*x-(I*n+v*h+L*x)),e[6]=F*(R*n+v*c+k*x-(M*n+C*c+O*x)),e[7]=F*(D*n+L*c+O*h-(P*n+V*c+k*h)),e[8]=F*($*f+H*y+W*_-(G*f+Y*y+le*_)),e[9]=F*(G*o+ye*y+pe*_-($*o+xe*y+Ae*_)),e[10]=F*(Y*o+xe*f+Te*_-(H*o+ye*f+me*_)),e[11]=F*(le*o+Ae*f+me*y-(W*o+pe*f+Te*y)),e[12]=F*(Y*l+le*E+G*u-(W*E+$*u+H*l)),e[13]=F*(Ae*E+$*i+xe*l-(ye*l+pe*E+G*i)),e[14]=F*(ye*u+me*E+H*i-(Te*E+Y*i+xe*u)),e[15]=F*(Te*l+W*i+pe*u-(Ae*u+me*l+le*i)),e}function hn(t,e,n){n=n||new b(16);const r=t[0],i=t[1],o=t[2],c=t[3],s=t[4+0],u=t[4+1],f=t[4+2],h=t[4+3],a=t[8+0],l=t[8+1],y=t[8+2],x=t[8+3],m=t[12+0],E=t[12+1],_=t[12+2],T=t[12+3],I=e[0],M=e[1],R=e[2],D=e[3],P=e[4+0],v=e[4+1],C=e[4+2],V=e[4+3],L=e[8+0],O=e[8+1],k=e[8+2],$=e[8+3],G=e[12+0],Y=e[12+1],H=e[12+2],W=e[12+3];return n[0]=r*I+s*M+a*R+m*D,n[1]=i*I+u*M+l*R+E*D,n[2]=o*I+f*M+y*R+_*D,n[3]=c*I+h*M+x*R+T*D,n[4]=r*P+s*v+a*C+m*V,n[5]=i*P+u*v+l*C+E*V,n[6]=o*P+f*v+y*C+_*V,n[7]=c*P+h*v+x*C+T*V,n[8]=r*L+s*O+a*k+m*$,n[9]=i*L+u*O+l*k+E*$,n[10]=o*L+f*O+y*k+_*$,n[11]=c*L+h*O+x*k+T*$,n[12]=r*G+s*Y+a*H+m*W,n[13]=i*G+u*Y+l*H+E*W,n[14]=o*G+f*Y+y*H+_*W,n[15]=c*G+h*Y+x*H+T*W,n}function ln(t,e,n){return n=n||ke(),t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11]),n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function yn(t,e){return e=e||N(),e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function xn(t,e,n){n=n||N();const r=e*4;return n[0]=t[r+0],n[1]=t[r+1],n[2]=t[r+2],n}function An(t,e,n,r){r!==t&&(r=Oe(t,r));const i=n*4;return r[i+0]=e[0],r[i+1]=e[1],r[i+2]=e[2],r}function pn(t,e,n,r,i){i=i||new b(16);const o=Math.tan(Math.PI*.5-.5*t),c=1/(n-r);return i[0]=o/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(n+r)*c,i[11]=-1,i[12]=0,i[13]=0,i[14]=n*r*c*2,i[15]=0,i}function Tn(t,e,n,r,i,o,c){return c=c||new b(16),c[0]=2/(e-t),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=2/(r-n),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2/(i-o),c[11]=0,c[12]=(e+t)/(t-e),c[13]=(r+n)/(n-r),c[14]=(o+i)/(i-o),c[15]=1,c}function mn(t,e,n,r,i,o,c){c=c||new b(16);const s=e-t,u=r-n,f=i-o;return c[0]=2*i/s,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=2*i/u,c[6]=0,c[7]=0,c[8]=(t+e)/s,c[9]=(r+n)/u,c[10]=o/f,c[11]=-1,c[12]=0,c[13]=0,c[14]=i*o/f,c[15]=0,c}let Z,Q,K;function Sn(t,e,n,r){return r=r||new b(16),Z=Z||N(),Q=Q||N(),K=K||N(),ee(Le(t,e,K),K),ee(Se(n,K,Z),Z),ee(Se(K,Z,Q),Q),r[0]=Z[0],r[1]=Z[1],r[2]=Z[2],r[3]=0,r[4]=Q[0],r[5]=Q[1],r[6]=Q[2],r[7]=0,r[8]=K[0],r[9]=K[1],r[10]=K[2],r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function En(t,e){return e=e||new b(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function _n(t,e,n){n=n||new b(16);const r=e[0],i=e[1],o=e[2],c=t[0],s=t[1],u=t[2],f=t[3],h=t[1*4+0],a=t[1*4+1],l=t[1*4+2],y=t[1*4+3],x=t[2*4+0],m=t[2*4+1],E=t[2*4+2],_=t[2*4+3],T=t[3*4+0],I=t[3*4+1],M=t[3*4+2],R=t[3*4+3];return t!==n&&(n[0]=c,n[1]=s,n[2]=u,n[3]=f,n[4]=h,n[5]=a,n[6]=l,n[7]=y,n[8]=x,n[9]=m,n[10]=E,n[11]=_),n[12]=c*r+h*i+x*o+T,n[13]=s*r+a*i+m*o+I,n[14]=u*r+l*i+E*o+M,n[15]=f*r+y*i+_*o+R,n}function bn(t,e){e=e||new b(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Bn(t,e,n){n=n||new b(16);const r=t[4],i=t[5],o=t[6],c=t[7],s=t[8],u=t[9],f=t[10],h=t[11],a=Math.cos(e),l=Math.sin(e);return n[4]=a*r+l*s,n[5]=a*i+l*u,n[6]=a*o+l*f,n[7]=a*c+l*h,n[8]=a*s-l*r,n[9]=a*u-l*i,n[10]=a*f-l*o,n[11]=a*h-l*c,t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n}function wn(t,e){e=e||new b(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function In(t,e,n){n=n||new b(16);const r=t[0*4+0],i=t[0*4+1],o=t[0*4+2],c=t[0*4+3],s=t[2*4+0],u=t[2*4+1],f=t[2*4+2],h=t[2*4+3],a=Math.cos(e),l=Math.sin(e);return n[0]=a*r-l*s,n[1]=a*i-l*u,n[2]=a*o-l*f,n[3]=a*c-l*h,n[8]=a*s+l*r,n[9]=a*u+l*i,n[10]=a*f+l*o,n[11]=a*h+l*c,t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n}function Mn(t,e){e=e||new b(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Rn(t,e,n){n=n||new b(16);const r=t[0*4+0],i=t[0*4+1],o=t[0*4+2],c=t[0*4+3],s=t[1*4+0],u=t[1*4+1],f=t[1*4+2],h=t[1*4+3],a=Math.cos(e),l=Math.sin(e);return n[0]=a*r+l*s,n[1]=a*i+l*u,n[2]=a*o+l*f,n[3]=a*c+l*h,n[4]=a*s-l*r,n[5]=a*u-l*i,n[6]=a*f-l*o,n[7]=a*h-l*c,t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n}function Dn(t,e,n){n=n||new b(16);let r=t[0],i=t[1],o=t[2];const c=Math.sqrt(r*r+i*i+o*o);r/=c,i/=c,o/=c;const s=r*r,u=i*i,f=o*o,h=Math.cos(e),a=Math.sin(e),l=1-h;return n[0]=s+(1-s)*h,n[1]=r*i*l+o*a,n[2]=r*o*l-i*a,n[3]=0,n[4]=r*i*l-o*a,n[5]=u+(1-u)*h,n[6]=i*o*l+r*a,n[7]=0,n[8]=r*o*l+i*a,n[9]=i*o*l-r*a,n[10]=f+(1-f)*h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Fn(t,e,n,r){r=r||new b(16);let i=e[0],o=e[1],c=e[2];const s=Math.sqrt(i*i+o*o+c*c);i/=s,o/=s,c/=s;const u=i*i,f=o*o,h=c*c,a=Math.cos(n),l=Math.sin(n),y=1-a,x=u+(1-u)*a,m=i*o*y+c*l,E=i*c*y-o*l,_=i*o*y-c*l,T=f+(1-f)*a,I=o*c*y+i*l,M=i*c*y+o*l,R=o*c*y-i*l,D=h+(1-h)*a,P=t[0],v=t[1],C=t[2],V=t[3],L=t[4],O=t[5],k=t[6],$=t[7],G=t[8],Y=t[9],H=t[10],W=t[11];return r[0]=x*P+m*L+E*G,r[1]=x*v+m*O+E*Y,r[2]=x*C+m*k+E*H,r[3]=x*V+m*$+E*W,r[4]=_*P+T*L+I*G,r[5]=_*v+T*O+I*Y,r[6]=_*C+T*k+I*H,r[7]=_*V+T*$+I*W,r[8]=M*P+R*L+D*G,r[9]=M*v+R*O+D*Y,r[10]=M*C+R*k+D*H,r[11]=M*V+R*$+D*W,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}function Nn(t,e){return e=e||new b(16),e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function zn(t,e,n){n=n||new b(16);const r=e[0],i=e[1],o=e[2];return n[0]=r*t[0*4+0],n[1]=r*t[0*4+1],n[2]=r*t[0*4+2],n[3]=r*t[0*4+3],n[4]=i*t[1*4+0],n[5]=i*t[1*4+1],n[6]=i*t[1*4+2],n[7]=i*t[1*4+3],n[8]=o*t[2*4+0],n[9]=o*t[2*4+1],n[10]=o*t[2*4+2],n[11]=o*t[2*4+3],t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n}function Un(t,e,n){n=n||N();const r=e[0],i=e[1],o=e[2],c=r*t[0*4+3]+i*t[1*4+3]+o*t[2*4+3]+t[3*4+3];return n[0]=(r*t[0*4+0]+i*t[1*4+0]+o*t[2*4+0]+t[3*4+0])/c,n[1]=(r*t[0*4+1]+i*t[1*4+1]+o*t[2*4+1]+t[3*4+1])/c,n[2]=(r*t[0*4+2]+i*t[1*4+2]+o*t[2*4+2]+t[3*4+2])/c,n}function Pn(t,e,n){n=n||N();const r=e[0],i=e[1],o=e[2];return n[0]=r*t[0*4+0]+i*t[1*4+0]+o*t[2*4+0],n[1]=r*t[0*4+1]+i*t[1*4+1]+o*t[2*4+1],n[2]=r*t[0*4+2]+i*t[1*4+2]+o*t[2*4+2],n}function gn(t,e,n){n=n||N();const r=$e(t),i=e[0],o=e[1],c=e[2];return n[0]=i*r[0*4+0]+o*r[0*4+1]+c*r[0*4+2],n[1]=i*r[1*4+0]+o*r[1*4+1]+c*r[1*4+2],n[2]=i*r[2*4+0]+o*r[2*4+1]+c*r[2*4+2],n}var te=Object.freeze({__proto__:null,axisRotate:Fn,axisRotation:Dn,copy:Oe,create:fn,frustum:mn,getAxis:xn,getTranslation:yn,identity:ke,inverse:$e,lookAt:Sn,multiply:hn,negate:un,ortho:Tn,perspective:pn,rotateX:Bn,rotateY:In,rotateZ:Rn,rotationX:bn,rotationY:wn,rotationZ:Mn,scale:zn,scaling:Nn,setAxis:An,setDefaultType:sn,setTranslation:ln,transformDirection:Pn,transformNormal:gn,transformPoint:Un,translate:_n,translation:En,transpose:an});const Ee=5120,d=5121,_e=5122,be=5123,Be=5124,we=5125,Ie=5126,vn=32819,Cn=32820,Vn=33635,Ln=5131,On=33640,kn=35899,$n=35902,Gn=36269,Yn=34042,Ge={};{const t=Ge;t[Ee]=Int8Array,t[d]=Uint8Array,t[_e]=Int16Array,t[be]=Uint16Array,t[Be]=Int32Array,t[we]=Uint32Array,t[Ie]=Float32Array,t[vn]=Uint16Array,t[Cn]=Uint16Array,t[Vn]=Uint16Array,t[Ln]=Uint16Array,t[On]=Uint32Array,t[kn]=Uint32Array,t[$n]=Uint32Array,t[Gn]=Uint32Array,t[Yn]=Uint32Array}function Ye(t){if(t instanceof Int8Array)return Ee;if(t instanceof Uint8Array||t instanceof Uint8ClampedArray)return d;if(t instanceof Int16Array)return _e;if(t instanceof Uint16Array)return be;if(t instanceof Int32Array)return Be;if(t instanceof Uint32Array)return we;if(t instanceof Float32Array)return Ie;throw new Error("unsupported typed array type")}function He(t){if(t===Int8Array)return Ee;if(t===Uint8Array||t===Uint8ClampedArray)return d;if(t===Int16Array)return _e;if(t===Uint16Array)return be;if(t===Int32Array)return Be;if(t===Uint32Array)return we;if(t===Float32Array)return Ie;throw new Error("unsupported typed array type")}function Hn(t){const e=Ge[t];if(!e)throw new Error("unknown gl type");return e}const Me=typeof SharedArrayBuffer<"u"?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};function Wn(...t){console.error(...t)}const We=new Map;function qe(t,e){if(!t||typeof t!="object")return!1;let n=We.get(e);n||(n=new WeakMap,We.set(e,n));let r=n.get(t);if(r===void 0){const i=Object.prototype.toString.call(t);r=i.substring(8,i.length-1)===e,n.set(t,r)}return r}function qn(t,e){return typeof WebGLBuffer<"u"&&qe(e,"WebGLBuffer")}function Xe(t,e){return typeof WebGLTexture<"u"&&qe(e,"WebGLTexture")}const je=35044,q=34962,Xn=34963,jn=34660,Kn=5120,Zn=5121,Jn=5122,Qn=5123,dn=5124,er=5125,Ke=5126,Ze={attribPrefix:""};function Je(t,e,n,r,i){t.bindBuffer(e,n),t.bufferData(e,r,i||je)}function Qe(t,e,n,r){if(qn(t,e))return e;n=n||q;const i=t.createBuffer();return Je(t,n,i,e,r),i}function de(t){return t==="indices"}function tr(t){return t===Int8Array||t===Uint8Array}function nr(t){return t.length?t:t.data}const rr=/coord|texture/i,ir=/color|colour/i;function or(t,e){let n;if(rr.test(t)?n=2:ir.test(t)?n=4:n=3,e%n>0)throw new Error(`Can not guess numComponents for attribute '${t}'. Tried ${n} but ${e} values is not evenly divisible by ${n}. You should specify it.`);return n}function cr(t,e,n){return t.numComponents||t.size||or(e,n||nr(t).length)}function Re(t,e){if(Me(t))return t;if(Me(t.data))return t.data;Array.isArray(t)&&(t={data:t});let n=t.type?De(t.type):void 0;return n||(de(e)?n=Uint16Array:n=Float32Array),new n(t.data)}function sr(t){return typeof t=="number"?t:t?He(t):Ke}function De(t){return typeof t=="number"?Hn(t):t||Float32Array}function ur(t,e){return{buffer:e.buffer,numValues:2*3*4,type:sr(e.type),arrayType:De(e.type)}}function fr(t,e){const n=e.data||e,r=De(e.type),i=n*r.BYTES_PER_ELEMENT,o=t.createBuffer();return t.bindBuffer(q,o),t.bufferData(q,i,e.drawType||je),{buffer:o,numValues:n,type:He(r),arrayType:r}}function ar(t,e,n){const r=Re(e,n);return{arrayType:r.constructor,buffer:Qe(t,r,void 0,e.drawType),type:Ye(r),numValues:0}}function hr(t,e){const n={};return Object.keys(e).forEach(function(r){if(!de(r)){const i=e[r],o=i.attrib||i.name||i.attribName||Ze.attribPrefix+r;if(i.value){if(!Array.isArray(i.value)&&!Me(i.value))throw new Error("array.value is not array or typedarray");n[o]={value:i.value}}else{let c;i.buffer&&i.buffer instanceof WebGLBuffer?c=ur:typeof i=="number"||typeof i.data=="number"?c=fr:c=ar;const{buffer:s,type:u,numValues:f,arrayType:h}=c(t,i,r),a=i.normalize!==void 0?i.normalize:tr(h),l=cr(i,r,f);n[o]={buffer:s,numComponents:l,type:u,normalize:a,stride:i.stride||0,offset:i.offset||0,divisor:i.divisor===void 0?void 0:i.divisor,drawType:i.drawType}}}}),t.bindBuffer(q,null),n}function et(t,e,n,r){n=Re(n),r!==void 0?(t.bindBuffer(q,e.buffer),t.bufferSubData(q,r,n)):Je(t,q,e.buffer,n,e.drawType)}function lr(t,e){return e===Kn||e===Zn?1:e===Jn||e===Qn?2:e===dn||e===er||e===Ke?4:0}const Fe=["position","positions","a_position"];function yr(t,e){let n,r;for(r=0;r<Fe.length&&(n=Fe[r],!(n in e||(n=Ze.attribPrefix+n,n in e)));++r);r===Fe.length&&(n=Object.keys(e)[0]);const i=e[n];if(!i.buffer)return 1;t.bindBuffer(q,i.buffer);const o=t.getBufferParameter(q,jn);t.bindBuffer(q,null);const c=lr(t,i.type),s=o/c,u=i.numComponents||i.size,f=s/u;if(f%1!==0)throw new Error(`numComponents ${u} not correct for length ${length}`);return f}function xr(t,e,n){const r=hr(t,e),i=Object.assign({},n||{});i.attribs=Object.assign({},n?n.attribs:{},r);const o=e.indices;if(o){const c=Re(o,"indices");i.indices=Qe(t,c,Xn),i.numElements=c.length,i.elementType=Ye(c)}else i.numElements||(i.numElements=yr(t,i.attribs));return i}function Ne(t){return!!t.texStorage2D}const Ar=function(){const t={},e={};function n(r){const i=r.constructor.name;if(!t[i]){for(const o in r)if(typeof r[o]=="number"){const c=e[r[o]];e[r[o]]=c?`${c} | ${o}`:o}t[i]=!0}}return function(i,o){return n(i),e[o]||(typeof o=="number"?`0x${o.toString(16)}`:o)}}(),ze=Wn;function tt(t){return typeof document<"u"&&document.getElementById?document.getElementById(t):null}const ne=33984,re=34962,pr=34963,Tr=35713,mr=35714,Sr=35632,Er=35633,_r=35981,nt=35718,br=35721,Br=35971,wr=35382,Ir=35396,Mr=35398,Rr=35392,Dr=35395,ie=5126,rt=35664,it=35665,ot=35666,Ue=5124,ct=35667,st=35668,ut=35669,ft=35670,at=35671,ht=35672,lt=35673,yt=35674,xt=35675,At=35676,Fr=35678,Nr=35680,zr=35679,Ur=35682,Pr=35685,gr=35686,vr=35687,Cr=35688,Vr=35689,Lr=35690,Or=36289,kr=36292,$r=36293,Pe=5125,pt=36294,Tt=36295,mt=36296,Gr=36298,Yr=36299,Hr=36300,Wr=36303,qr=36306,Xr=36307,jr=36308,Kr=36311,oe=3553,ce=34067,ge=32879,se=35866,A={};function St(t,e){return A[e].bindPoint}function Zr(t,e){return function(n){t.uniform1f(e,n)}}function Jr(t,e){return function(n){t.uniform1fv(e,n)}}function Qr(t,e){return function(n){t.uniform2fv(e,n)}}function dr(t,e){return function(n){t.uniform3fv(e,n)}}function ei(t,e){return function(n){t.uniform4fv(e,n)}}function Et(t,e){return function(n){t.uniform1i(e,n)}}function _t(t,e){return function(n){t.uniform1iv(e,n)}}function bt(t,e){return function(n){t.uniform2iv(e,n)}}function Bt(t,e){return function(n){t.uniform3iv(e,n)}}function wt(t,e){return function(n){t.uniform4iv(e,n)}}function ti(t,e){return function(n){t.uniform1ui(e,n)}}function ni(t,e){return function(n){t.uniform1uiv(e,n)}}function ri(t,e){return function(n){t.uniform2uiv(e,n)}}function ii(t,e){return function(n){t.uniform3uiv(e,n)}}function oi(t,e){return function(n){t.uniform4uiv(e,n)}}function ci(t,e){return function(n){t.uniformMatrix2fv(e,!1,n)}}function si(t,e){return function(n){t.uniformMatrix3fv(e,!1,n)}}function ui(t,e){return function(n){t.uniformMatrix4fv(e,!1,n)}}function fi(t,e){return function(n){t.uniformMatrix2x3fv(e,!1,n)}}function ai(t,e){return function(n){t.uniformMatrix3x2fv(e,!1,n)}}function hi(t,e){return function(n){t.uniformMatrix2x4fv(e,!1,n)}}function li(t,e){return function(n){t.uniformMatrix4x2fv(e,!1,n)}}function yi(t,e){return function(n){t.uniformMatrix3x4fv(e,!1,n)}}function xi(t,e){return function(n){t.uniformMatrix4x3fv(e,!1,n)}}function z(t,e,n,r){const i=St(t,e);return Ne(t)?function(o){let c,s;!o||Xe(t,o)?(c=o,s=null):(c=o.texture,s=o.sampler),t.uniform1i(r,n),t.activeTexture(ne+n),t.bindTexture(i,c),t.bindSampler(n,s)}:function(o){t.uniform1i(r,n),t.activeTexture(ne+n),t.bindTexture(i,o)}}function U(t,e,n,r,i){const o=St(t,e),c=new Int32Array(i);for(let s=0;s<i;++s)c[s]=n+s;return Ne(t)?function(s){t.uniform1iv(r,c),s.forEach(function(u,f){t.activeTexture(ne+c[f]);let h,a;!u||Xe(t,u)?(h=u,a=null):(h=u.texture,a=u.sampler),t.bindSampler(n,a),t.bindTexture(o,h)})}:function(s){t.uniform1iv(r,c),s.forEach(function(u,f){t.activeTexture(ne+c[f]),t.bindTexture(o,u)})}}A[ie]={Type:Float32Array,size:4,setter:Zr,arraySetter:Jr},A[rt]={Type:Float32Array,size:8,setter:Qr,cols:2},A[it]={Type:Float32Array,size:12,setter:dr,cols:3},A[ot]={Type:Float32Array,size:16,setter:ei,cols:4},A[Ue]={Type:Int32Array,size:4,setter:Et,arraySetter:_t},A[ct]={Type:Int32Array,size:8,setter:bt,cols:2},A[st]={Type:Int32Array,size:12,setter:Bt,cols:3},A[ut]={Type:Int32Array,size:16,setter:wt,cols:4},A[Pe]={Type:Uint32Array,size:4,setter:ti,arraySetter:ni},A[pt]={Type:Uint32Array,size:8,setter:ri,cols:2},A[Tt]={Type:Uint32Array,size:12,setter:ii,cols:3},A[mt]={Type:Uint32Array,size:16,setter:oi,cols:4},A[ft]={Type:Uint32Array,size:4,setter:Et,arraySetter:_t},A[at]={Type:Uint32Array,size:8,setter:bt,cols:2},A[ht]={Type:Uint32Array,size:12,setter:Bt,cols:3},A[lt]={Type:Uint32Array,size:16,setter:wt,cols:4},A[yt]={Type:Float32Array,size:32,setter:ci,rows:2,cols:2},A[xt]={Type:Float32Array,size:48,setter:si,rows:3,cols:3},A[At]={Type:Float32Array,size:64,setter:ui,rows:4,cols:4},A[Pr]={Type:Float32Array,size:32,setter:fi,rows:2,cols:3},A[gr]={Type:Float32Array,size:32,setter:hi,rows:2,cols:4},A[vr]={Type:Float32Array,size:48,setter:ai,rows:3,cols:2},A[Cr]={Type:Float32Array,size:48,setter:yi,rows:3,cols:4},A[Vr]={Type:Float32Array,size:64,setter:li,rows:4,cols:2},A[Lr]={Type:Float32Array,size:64,setter:xi,rows:4,cols:3},A[Fr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:oe},A[Nr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:ce},A[zr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:ge},A[Ur]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:oe},A[Or]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:se},A[kr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:se},A[$r]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:ce},A[Gr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:oe},A[Yr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:ge},A[Hr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:ce},A[Wr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:se},A[qr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:oe},A[Xr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:ge},A[jr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:ce},A[Kr]={Type:null,size:0,setter:z,arraySetter:U,bindPoint:se};function ue(t,e){return function(n){if(n.value)switch(t.disableVertexAttribArray(e),n.value.length){case 4:t.vertexAttrib4fv(e,n.value);break;case 3:t.vertexAttrib3fv(e,n.value);break;case 2:t.vertexAttrib2fv(e,n.value);break;case 1:t.vertexAttrib1fv(e,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else t.bindBuffer(re,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,n.numComponents||n.size,n.type||ie,n.normalize||!1,n.stride||0,n.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,n.divisor||0)}}function J(t,e){return function(n){if(n.value)if(t.disableVertexAttribArray(e),n.value.length===4)t.vertexAttrib4iv(e,n.value);else throw new Error("The length of an integer constant value must be 4!");else t.bindBuffer(re,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.numComponents||n.size,n.type||Ue,n.stride||0,n.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,n.divisor||0)}}function fe(t,e){return function(n){if(n.value)if(t.disableVertexAttribArray(e),n.value.length===4)t.vertexAttrib4uiv(e,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else t.bindBuffer(re,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.numComponents||n.size,n.type||Pe,n.stride||0,n.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,n.divisor||0)}}function ve(t,e,n){const r=n.size,i=n.count;return function(o){t.bindBuffer(re,o.buffer);const c=o.size||o.numComponents||r,s=c/i,u=o.type||ie,h=A[u].size*c,a=o.normalize||!1,l=o.offset||0,y=h/i;for(let x=0;x<i;++x)t.enableVertexAttribArray(e+x),t.vertexAttribPointer(e+x,s,u,a,h,l+y*x),t.vertexAttribDivisor&&t.vertexAttribDivisor(e+x,o.divisor||0)}}const w={};w[ie]={size:4,setter:ue},w[rt]={size:8,setter:ue},w[it]={size:12,setter:ue},w[ot]={size:16,setter:ue},w[Ue]={size:4,setter:J},w[ct]={size:8,setter:J},w[st]={size:12,setter:J},w[ut]={size:16,setter:J},w[Pe]={size:4,setter:fe},w[pt]={size:8,setter:fe},w[Tt]={size:12,setter:fe},w[mt]={size:16,setter:fe},w[ft]={size:4,setter:J},w[at]={size:8,setter:J},w[ht]={size:12,setter:J},w[lt]={size:16,setter:J},w[yt]={size:4,setter:ve,count:2},w[xt]={size:9,setter:ve,count:3},w[At]={size:16,setter:ve,count:4};const Ai=/ERROR:\s*\d+:(\d+)/gi;function pi(t,e="",n=0){const r=[...e.matchAll(Ai)],i=new Map(r.map((o,c)=>{const s=parseInt(o[1]),u=r[c+1],f=u?u.index:e.length,h=e.substring(o.index,f);return[s-1,h]}));return t.split(`
`).map((o,c)=>{const s=i.get(c);return`${c+1+n}: ${o}${s?`

^^^ ${s}`:""}`}).join(`
`)}const It=/^[ \t]*\n/;function Mt(t){let e=0;return It.test(t)&&(e=1,t=t.replace(It,"")),{lineOffset:e,shaderSource:t}}function Ti(t,e){return t.errorCallback(e),t.callback&&setTimeout(()=>{t.callback(`${e}
${t.errors.join(`
`)}`)}),null}function mi(t,e,n,r){if(r=r||ze,!t.getShaderParameter(n,Tr)){const o=t.getShaderInfoLog(n),{lineOffset:c,shaderSource:s}=Mt(t.getShaderSource(n)),u=`${pi(s,o,c)}
Error compiling ${Ar(t,e)}: ${o}`;return r(u),u}return""}function Ce(t,e,n){let r,i,o;if(typeof e=="function"&&(n=e,e=void 0),typeof t=="function")n=t,t=void 0;else if(t&&!Array.isArray(t)){const f=t;n=f.errorCallback,t=f.attribLocations,r=f.transformFeedbackVaryings,i=f.transformFeedbackMode,o=f.callback}const c=n||ze,s=[],u={errorCallback(f,...h){s.push(f),c(f,...h)},transformFeedbackVaryings:r,transformFeedbackMode:i,callback:o,errors:s};{let f={};Array.isArray(t)?t.forEach(function(h,a){f[h]=e?e[a]:a}):f=t||{},u.attribLocations=f}return u}const Si=["VERTEX_SHADER","FRAGMENT_SHADER"];function Ei(t,e){if(e.indexOf("frag")>=0)return Sr;if(e.indexOf("vert")>=0)return Er}function _i(t,e,n){const r=t.getAttachedShaders(e);for(const i of r)n.has(i)&&t.deleteShader(i);t.deleteProgram(e)}const bi=(t=0)=>new Promise(e=>setTimeout(e,t));function Bi(t,e,n){const r=t.createProgram(),{attribLocations:i,transformFeedbackVaryings:o,transformFeedbackMode:c}=Ce(n);for(let s=0;s<e.length;++s){let u=e[s];if(typeof u=="string"){const f=tt(u),h=f?f.text:u;let a=t[Si[s]];f&&f.type&&(a=Ei(t,f.type)||a),u=t.createShader(a),t.shaderSource(u,Mt(h).shaderSource),t.compileShader(u),t.attachShader(r,u)}}Object.entries(i).forEach(([s,u])=>t.bindAttribLocation(r,u,s));{let s=o;s&&(s.attribs&&(s=s.attribs),Array.isArray(s)||(s=Object.keys(s)),t.transformFeedbackVaryings(r,s,c||_r))}return t.linkProgram(r),r}function wi(t,e,n,r,i){const o=Ce(n,r,i),c=new Set(e),s=Bi(t,e,o);function u(f,h){const a=Mi(f,h,o.errorCallback);return a&&_i(f,h,c),a}if(o.callback){Ii(t,s).then(()=>{const f=u(t,s);o.callback(f,f?void 0:s)});return}return u(t,s)?void 0:s}async function Ii(t,e){const n=t.getExtension("KHR_parallel_shader_compile"),r=n?(o,c)=>o.getProgramParameter(c,n.COMPLETION_STATUS_KHR):()=>!0;let i=0;do await bi(i),i=1e3/60;while(!r(t,e))}function Mi(t,e,n){if(n=n||ze,!t.getProgramParameter(e,mr)){const i=t.getProgramInfoLog(e);n(`Error in program linking: ${i}`);const c=t.getAttachedShaders(e).map(s=>mi(t,t.getShaderParameter(s,t.SHADER_TYPE),s,n));return`${i}
${c.filter(s=>s).join(`
`)}`}}function Ri(t,e,n,r,i){return wi(t,e,n,r,i)}function Rt(t){const e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const Di=/(\.|\[|]|\w+)/g,Fi=t=>t>="0"&&t<="9";function Ni(t,e,n,r){const i=t.split(Di).filter(s=>s!=="");let o=0,c="";for(;;){const s=i[o++];c+=s;const u=Fi(s[0]),f=u?parseInt(s):s;if(u&&(c+=i[o++]),o===i.length){n[f]=e;break}else{const a=i[o++],l=a==="[",y=n[f]||(l?[]:{});n[f]=y,n=y,r[c]=r[c]||function(x){return function(m){Dt(x,m)}}(y),c+=a}}}function zi(t,e){let n=0;function r(s,u,f){const h=u.name.endsWith("[0]"),a=u.type,l=A[a];if(!l)throw new Error(`unknown type: 0x${a.toString(16)}`);let y;if(l.bindPoint){const x=n;n+=u.size,h?y=l.arraySetter(t,a,x,f,u.size):y=l.setter(t,a,x,f,u.size)}else l.arraySetter&&h?y=l.arraySetter(t,f):y=l.setter(t,f);return y.location=f,y}const i={},o={},c=t.getProgramParameter(e,nt);for(let s=0;s<c;++s){const u=t.getActiveUniform(e,s);if(Rt(u))continue;let f=u.name;f.endsWith("[0]")&&(f=f.substr(0,f.length-3));const h=t.getUniformLocation(e,u.name);if(h){const a=r(e,u,h);i[f]=a,Ni(f,a,o,i)}}return i}function Ui(t,e){const n={},r=t.getProgramParameter(e,Br);for(let i=0;i<r;++i){const o=t.getTransformFeedbackVarying(e,i);n[o.name]={index:i,type:o.type,size:o.size}}return n}function Pi(t,e){const n=t.getProgramParameter(e,nt),r=[],i=[];for(let s=0;s<n;++s){i.push(s),r.push({});const u=t.getActiveUniform(e,s);r[s].name=u.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(s){const u=s[0],f=s[1];t.getActiveUniforms(e,i,t[u]).forEach(function(h,a){r[a][f]=h})});const o={},c=t.getProgramParameter(e,wr);for(let s=0;s<c;++s){const u=t.getActiveUniformBlockName(e,s),f={index:t.getUniformBlockIndex(e,u),usedByVertexShader:t.getActiveUniformBlockParameter(e,s,Ir),usedByFragmentShader:t.getActiveUniformBlockParameter(e,s,Mr),size:t.getActiveUniformBlockParameter(e,s,Rr),uniformIndices:t.getActiveUniformBlockParameter(e,s,Dr)};f.used=f.usedByVertexShader||f.usedByFragmentShader,o[u]=f}return{blockSpecs:o,uniformData:r}}function Dt(t,e){for(const n in e){const r=t[n];typeof r=="function"?r(e[n]):Dt(t[n],e[n])}}function Ft(t,...e){const n=t.uniformSetters||t,r=e.length;for(let i=0;i<r;++i){const o=e[i];if(Array.isArray(o)){const c=o.length;for(let s=0;s<c;++s)Ft(n,o[s])}else for(const c in o){const s=n[c];s&&s(o[c])}}}function gi(t,e){const n={},r=t.getProgramParameter(e,br);for(let i=0;i<r;++i){const o=t.getActiveAttrib(e,i);if(Rt(o))continue;const c=t.getAttribLocation(e,o.name),s=w[o.type],u=s.setter(t,c,s);u.location=c,n[o.name]=u}return n}function vi(t,e){for(const n in e){const r=t[n];r&&r(e[n])}}function Ci(t,e,n){n.vertexArrayObject?t.bindVertexArray(n.vertexArrayObject):(vi(e.attribSetters||e,n.attribs),n.indices&&t.bindBuffer(pr,n.indices))}function Nt(t,e){const n=zi(t,e),r=gi(t,e),i={program:e,uniformSetters:n,attribSetters:r};return Ne(t)&&(i.uniformBlockSpec=Pi(t,e),i.transformFeedbackInfo=Ui(t,e)),i}const Vi=/\s|{|}|;/;function Li(t,e,n,r,i){const o=Ce(n,r,i),c=[];if(e=e.map(function(f){if(!Vi.test(f)){const h=tt(f);if(h)f=h.text;else{const a=`no element with id: ${f}`;o.errorCallback(a),c.push(a)}}return f}),c.length)return Ti(o,"");const s=o.callback;s&&(o.callback=(f,h)=>{s(f,f?void 0:Nt(t,h))});const u=Ri(t,e,o);return u?Nt(t,u):null}const Oi=4,zt=5123;function ki(t,e,n,r,i,o){n=n===void 0?Oi:n;const c=e.indices,s=e.elementType,u=r===void 0?e.numElements:r;i=i===void 0?0:i,s||c?o!==void 0?t.drawElementsInstanced(n,u,s===void 0?zt:e.elementType,i,o):t.drawElements(n,u,s===void 0?zt:e.elementType,i):o!==void 0?t.drawArraysInstanced(n,i,u,o):t.drawArrays(n,i,u)}function $i(t,e){e=e||1,e=Math.max(0,e);const n=t.clientWidth*e|0,r=t.clientHeight*e|0;return t.width!==n||t.height!==r?(t.width=n,t.height=r,!0):!1}const Ut={vertexShader:`
attribute vec2 position;
attribute vec4 color;

varying vec4 v_color;

uniform mat4 u_matrix;


void main() {
  gl_Position = u_matrix * vec4(position.x, position.y, 0.0, 1.0);
  v_color = color;
}
`,fragmentShader:`
precision mediump float;

varying vec4 v_color;

void main() {
  // vec2 uv = gl_FragCoord.xy / resolution;

  gl_FragColor = v_color;
}

  `};class X{constructor(e,n){p(this,"pos");p(this,"color");this.pos=e,this.color=n}}class Pt{constructor(e,n){p(this,"positions");p(this,"colors");p(this,"indices");p(this,"bufferInfo");p(this,"currentVertices",0);p(this,"currentIndices",0);p(this,"vertexCapacity",0);p(this,"indexCapacity",0);if(n.positions&&n.colors&&n.indices)this.positions=n.positions,this.colors=n.colors,this.indices=n.indices;else if(n.numVertices)this.positions=new Float32Array(n.numVertices*2),this.colors=new Uint8Array(n.numVertices*4),this.indices=new Uint16Array(n.numVertices*3);else throw new Error("Invalid BufferDataOptions! Must provide positions, colors, and indices arrays, or specify numVertices");this.vertexCapacity=this.positions.length/2,this.indexCapacity=this.indices.length,this.bufferInfo=xr(e,{position:{numComponents:2,data:this.positions,drawType:e.DYNAMIC_DRAW},color:{numComponents:4,data:this.colors,drawType:e.DYNAMIC_DRAW},indices:{numComponents:3,data:this.indices,drawType:e.DYNAMIC_DRAW}})}addVertex(e){this.positions[this.currentVertices*2+0]=e.pos.x,this.positions[this.currentVertices*2+1]=e.pos.y;for(let n=0;n<4;n++)this.colors[this.currentVertices*4+n]=e.color.array()[n];this.currentVertices++}addIndex(e){for(let n=0;n<e.length;n++)this.indices[this.currentIndices+n]=e[n]+this.currentVertices;this.currentIndices+=e.length}updateBufferData(e){et(e,this.bufferInfo.attribs.position,this.positions),et(e,this.bufferInfo.attribs.color,this.colors),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.bufferInfo.indices),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.DYNAMIC_DRAW)}fill(){this.positions.fill(0,this.currentVertices*2),this.colors.fill(0,this.currentVertices*4),this.indices.fill(0,this.currentIndices)}resetCount(){this.currentVertices=0,this.currentIndices=0}}class gt{constructor(e){p(this,"gl");this.gl=e}addVerticesAndIndices(e,n){}updateBuffers(){}render(e){}}class vt extends gt{constructor(n,r){super(n);p(this,"buffers",[]);p(this,"bufferSize");p(this,"currentBufferIndex",-1);this.bufferSize=r.bufferSize,this.addBuffer()}addVerticesAndIndices(n,r){(this.buffers[this.currentBufferIndex].currentIndices+r.length>=this.buffers[this.currentBufferIndex].indexCapacity||this.buffers[this.currentBufferIndex].currentVertices+n.length>=this.buffers[this.currentBufferIndex].vertexCapacity)&&this.changeBuffer(),this.addIndices(r),this.addVertices(n)}updateBuffers(){this.buffers[this.currentBufferIndex].fill(),this.buffers[this.currentBufferIndex].updateBufferData(this.gl)}render(n){console.log(this.buffers);for(let r=0;r<=this.currentBufferIndex;r++)Ci(this.gl,n,this.buffers[r].bufferInfo),ki(this.gl,this.buffers[r].bufferInfo,this.gl.TRIANGLES,this.buffers[r].currentIndices)}reset(){this.currentBufferIndex=0;for(const n of this.buffers)n.resetCount()}addBuffer(){this.currentBufferIndex++,this.buffers.push(new Pt(this.gl,{numVertices:this.bufferSize}))}changeBuffer(){this.buffers[this.currentBufferIndex].fill(),this.buffers[this.currentBufferIndex].updateBufferData(this.gl),this.buffers.length<=this.currentBufferIndex+1?this.addBuffer():this.currentBufferIndex++}addVertex(n){this.buffers[this.currentBufferIndex].addVertex(n)}addIndices(n){this.buffers[this.currentBufferIndex].addIndex(n)}addVertices(n){for(let r=0;r<n.length;r++)this.addVertex(n[r])}}function Ve(t,e){return new j(t,e)}const B=class B{constructor(e,n){p(this,"x");p(this,"y");this.x=e,this.y=n}add(e,n){return e instanceof B?(this.x+=e.x,this.y+=e.y):n?(this.x+=e,this.y+=n):(this.x+=e,this.y+=e),this}static add(e,n){return new B(e.x+n.x,e.y+n.y)}mult(e,n){return e instanceof B?(this.x*=e.x,this.y*=e.y):n?(this.x*=e,this.y*=n):(this.x*=e,this.y*=e),this}static mult(e,n){return n instanceof B?new B(e.x*n.x,e.y*n.y):new B(e.x*n,e.y*n)}sub(e,n){return e instanceof B?(this.x-=e.x,this.y-=e.y):n?(this.x-=e,this.y-=n):(this.x-=e,this.y-=e),this}static sub(e,n){return new B(e.x-n.x,e.y-n.y)}div(e,n){return e instanceof B?(this.x/=e.x,this.y/=e.y):n?(this.x/=e,this.y/=n):(this.x/=e,this.y/=e),this}static div(e,n){return new B(e.x/n.x,e.y/n.y)}set(e,n){return e instanceof B?(this.x=e.x,this.y=e.y):n?(this.x=e,this.y=n):(this.x=e,this.y=e),this}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}static mag(e){return Math.sqrt(e.x*e.x+e.y*e.y)}magSq(){return this.x*this.x+this.y*this.y}static magSq(e){return e.x*e.x+e.y*e.y}setMag(e){let n=this.mag();return this.x*=e/n,this.y*=e/n,this}normalize(){return this.setMag(1),this}limit(e){return this.mag()>e&&this.setMag(e),this}heading(){return Math.atan2(this.y,this.x)}rotate(e){let n=Math.cos(e),r=Math.sin(e),i=n*this.x-r*this.y,o=n*this.y+r*this.x;return this.x=i,this.y=o,this}rotateAboutAxis(e,n){return this.sub(n).rotate(e).add(n),this}dot(e){return e.x*this.x+e.y*this.y}static dot(e,n){return e.x*n.x+e.y*n.y}cross(e){return this.x*e.y-this.y*e.x}static cross(e,n){return e.x*n.y-e.y*n.x}dist(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}static dist(e,n){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))}lerp(e,n){let r=e.x-this.x,i=e.y-this.y;return this.x+=n*r,this.y+=n*i,this}static angleBetween(e,n){return Math.atan2(e.x*n.y-e.y*n.x,e.x*n.x+e.y*n.y)}copy(){return new B(this.x,this.y)}};p(B,"zero",()=>new B(0,0)),p(B,"up",()=>new B(0,-1)),p(B,"down",()=>new B(0,1)),p(B,"left",()=>new B(-1,0)),p(B,"right",()=>new B(1,0));let j=B;function Gi(t,e,n){return new ae(t,e,n)}function Ct(t,e,n,r=255){return new ae(t,e,n,r)}class ae{constructor(e,n,r,i=255){p(this,"r");p(this,"g");p(this,"b");p(this,"a");this.r=e,this.g=n,this.b=r,this.a=i}array(){return[this.r,this.g,this.b,this.a]}static rgbToHex(e){return"#"+(1<<24|e.r<<16|e.g<<8|e.b).toString(16).slice(1)}static hexToRGBA(e,n=255){const r=parseInt(e.slice(1),16),i=r>>16&255,o=r>>8&255,c=r&255;return Ct(i,o,c,n)}}function Vt(t,e,n,r,i){return r+(t-e)*((i-r)/(n-e))}function he(t,e,n){const r=t.pos,i=e.pos,o=Math.atan2(i.y-r.y,i.x-r.x),c=Math.cos(o),s=Math.sin(o),u=r.x-n/2*s,f=r.y+n/2*c,h=r.x+n/2*s,a=r.y-n/2*c;return[new X(new j(u,f),t.color),new X(new j(h,a),t.color)]}function Lt(t,e,n,r){let i=t.pos.x,o=t.pos.y,c=e.pos.x,s=e.pos.y,u=n.pos.x,f=n.pos.y;const h=o-s,a=i-c,l=o*(i-c)-i*(o-s),y=s-f,x=c-u,m=s*(c-u)-c*(s-f),E=r/2*Math.sqrt(h*h+a*a)-l,_=r/2*Math.sqrt(h*h+a*a)+l,T=r/2*Math.sqrt(y*y+x*x)-m,I=r/2*Math.sqrt(y*y+x*x)+m,M=(a*T-x*E)/(h*x-y*a),R=(y*E-h*T)/(h*x-y*a),D=(a*I-x*_)/(h*x-y*a),P=(y*_-h*I)/(h*x-y*a);return[new X(new j(-M,R),e.color),new X(new j(D,-P),e.color)]}class Yi{constructor(e){p(this,"canvas");p(this,"gl");p(this,"shaderProgramInfo");p(this,"buffers",[]);p(this,"defaultBuffer");p(this,"currentPath",[]);e.canvas?this.canvas=e.canvas:(this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,document.body.appendChild(this.canvas));let n=null;if((e.webglVersion===2||!e.webglVersion)&&(n=this.canvas.getContext("webgl2"),n||console.warn("WebGL 2 not supported, falling back to WebGL 1")),(!n||e.webglVersion===1)&&(n=this.canvas.getContext("webgl")),!n)throw new Error("WebGL not supported");this.gl=n,this.shaderProgramInfo=Li(this.gl,[Ut.vertexShader,Ut.fragmentShader]),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE),$i(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.defaultBuffer=new vt(this.gl,{bufferSize:100})}addBuffer(e){this.buffers.push(e)}clear(e=new ae(0,0,0,255)){this.gl.clearColor(e.r/255,e.g/255,e.b/255,e.a/255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}line(e,n,r,i){const o=new X(e,i),c=new X(n,i);this.defaultBuffer.addVerticesAndIndices([...he(o,c,r),...he(c,o,r)],[0,1,2,0,2,3])}path(e,n,r=!1){const i=[],o=[],c=e[0],s=e[1];r?i.push(...Lt(e[e.length-1],c,s,n)):i.push(...he(c,s,n));for(let u=0;u<e.length-(r?1:2);u++)o.push(0+u*2,1+u*2,2+u*2,1+u*2,2+u*2,3+u*2),i.push(...Lt(e[u],e[u+1],e[(u+2)%e.length],n));if(r){const u=i.length-2;o.push(u,u+1,0,u+1,0,1)}else{const u=i.length-2;o.push(u+0,u+1,u+2,u+0,u+2,u+3),i.push(...he(e[e.length-1],e[e.length-2],n))}this.defaultBuffer.addVerticesAndIndices(i,o)}beginPath(){this.currentPath=[]}vertex(e,n){e instanceof X?this.currentPath.push(e):n&&this.currentPath.push(new X(e,n))}arc(e,n,r,i,o){const s=(i-r)/40,u=[];for(let f=0;f<=40;f++){const h=r+s*f;u.push(new X(new j(e.x+n*Math.cos(h),e.y+n*Math.sin(h)),o))}this.currentPath.push(...u)}strokePath(e,n=!1){this.path(this.currentPath,e,n)}fillPath(){const e=[];for(let n=1;n<this.currentPath.length-1;n++)e.push(0,n,n+1);this.defaultBuffer.addVerticesAndIndices(this.currentPath,e)}render(e){this.defaultBuffer.updateBuffers();const n={resolution:[this.gl.canvas.width,this.gl.canvas.height],u_matrix:e?e.getMatrix():te.identity()};this.gl.useProgram(this.shaderProgramInfo.program),Ft(this.shaderProgramInfo,n),this.defaultBuffer.render(this.shaderProgramInfo);for(const r of this.buffers)r.render(this.shaderProgramInfo);this.defaultBuffer.reset()}getDisplaySize(){return new j(this.canvas.width,this.canvas.height)}}class Hi{constructor(e){p(this,"zoom",1);p(this,"pos",Ve(0,0));p(this,"displaySize",Ve(0,0));p(this,"aspect",1);p(this,"matrix",te.identity());this.setDisplaySize(e)}translate(e){this.pos=this.pos.add(e),this.calculateMatrix()}setZoom(e){this.zoom=e,this.calculateMatrix()}setDisplaySize(e){this.displaySize=e,this.calculateAspectRatio(),this.calculateMatrix()}calculateAspectRatio(){this.aspect=this.displaySize.x/this.displaySize.y}calculateMatrix(){const e=this.displaySize.y/this.zoom;this.matrix=te.translate(te.ortho(-this.aspect*e,this.aspect*e,1*e,-1*e,-1,1),cn.create(-this.pos.x,-this.pos.y))}screenSpaceToWorldSpace(e){const n=window.innerHeight/this.zoom,r=Vt(e.x,0,window.innerWidth,-this.aspect*n,this.aspect*n)+this.pos.x,i=Vt(e.y,0,window.innerHeight,-1*n,1*n)+this.pos.y;return Ve(r,i)}getMatrix(){return this.matrix}}return{Renderer:Yi,DynamicBuffer:vt,Buffer:gt,BufferData:Pt,Camera:Hi,Color:ae,Vertex:X,Vector:j,RGB:Gi,RGBA:Ct}});
