(function(_,g){typeof exports=="object"&&typeof module<"u"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(_=typeof globalThis<"u"?globalThis:_||self,g(_.polyly={}))})(this,function(_){"use strict";/* @license twgl.js 5.5.3 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */let g=Float32Array;function Je(e){const t=g;return g=e,t}function q(e,t,n){const r=new g(3);return e&&(r[0]=e),t&&(r[1]=t),n&&(r[2]=n),r}function Qe(e,t,n){return n=n||new g(3),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function Yt(e,t,n){return n=n||new g(3),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function tn(e,t,n,r){return r=r||new g(3),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r}function en(e,t,n,r){return r=r||new g(3),r[0]=e[0]+n[0]*(t[0]-e[0]),r[1]=e[1]+n[1]*(t[1]-e[1]),r[2]=e[2]+n[2]*(t[2]-e[2]),r}function nn(e,t,n){return n=n||new g(3),n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function rn(e,t,n){return n=n||new g(3),n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function sn(e,t,n){return n=n||new g(3),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function on(e,t,n){return n=n||new g(3),n[0]=e[0]/t,n[1]=e[1]/t,n[2]=e[2]/t,n}function It(e,t,n){n=n||new g(3);const r=e[2]*t[0]-e[0]*t[2],i=e[0]*t[1]-e[1]*t[0];return n[0]=e[1]*t[2]-e[2]*t[1],n[1]=r,n[2]=i,n}function cn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function an(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function un(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}function fn(e,t){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function hn(e,t){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function rt(e,t){t=t||new g(3);const n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=Math.sqrt(n);return r>1e-5?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=0,t[1]=0,t[2]=0),t}function ln(e,t){return t=t||new g(3),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function xn(e,t){return t=t||new g(3),t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function yn(e,t,n){return n=n||new g(3),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}function pn(e,t,n){return n=n||new g(3),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n}var mn=Object.freeze({__proto__:null,add:Qe,copy:xn,create:q,cross:It,distance:fn,distanceSq:hn,divide:pn,divScalar:on,dot:cn,lerp:tn,lerpV:en,length:an,lengthSq:un,max:nn,min:rn,mulScalar:sn,multiply:yn,negate:ln,normalize:rt,setDefaultType:Je,subtract:Yt});let w=Float32Array;function An(e){const t=w;return w=e,t}function Sn(e,t){return t=t||new w(16),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t}function Tn(){return new w(16).fill(0)}function qt(e,t){return t=t||new w(16),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function jt(e){return e=e||new w(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bn(e,t){if(t=t||new w(16),t===e){let A;return A=e[1],e[1]=e[4],e[4]=A,A=e[2],e[2]=e[8],e[8]=A,A=e[3],e[3]=e[12],e[12]=A,A=e[6],e[6]=e[9],e[9]=A,A=e[7],e[7]=e[13],e[13]=A,A=e[11],e[11]=e[14],e[14]=A,t}const n=e[0*4+0],r=e[0*4+1],i=e[0*4+2],s=e[0*4+3],o=e[1*4+0],c=e[1*4+1],a=e[1*4+2],u=e[1*4+3],h=e[2*4+0],f=e[2*4+1],l=e[2*4+2],y=e[2*4+3],p=e[3*4+0],T=e[3*4+1],S=e[3*4+2],b=e[3*4+3];return t[0]=n,t[1]=o,t[2]=h,t[3]=p,t[4]=r,t[5]=c,t[6]=f,t[7]=T,t[8]=i,t[9]=a,t[10]=l,t[11]=S,t[12]=s,t[13]=u,t[14]=y,t[15]=b,t}function Xt(e,t){t=t||new w(16);const n=e[0*4+0],r=e[0*4+1],i=e[0*4+2],s=e[0*4+3],o=e[1*4+0],c=e[1*4+1],a=e[1*4+2],u=e[1*4+3],h=e[2*4+0],f=e[2*4+1],l=e[2*4+2],y=e[2*4+3],p=e[3*4+0],T=e[3*4+1],S=e[3*4+2],b=e[3*4+3],A=l*b,M=S*y,v=a*b,D=S*u,R=a*y,I=l*u,B=i*b,z=S*s,L=i*y,V=l*s,d=i*u,k=a*s,O=h*T,$=p*f,G=o*T,W=p*c,H=o*f,At=h*c,St=n*T,Tt=p*r,bt=n*f,wt=h*r,Et=n*c,gt=o*r,je=A*c+D*f+R*T-(M*c+v*f+I*T),Xe=M*r+B*f+V*T-(A*r+z*f+L*T),Ke=v*r+z*c+d*T-(D*r+B*c+k*T),Ze=I*r+L*c+k*f-(R*r+V*c+d*f),N=1/(n*je+o*Xe+h*Ke+p*Ze);return t[0]=N*je,t[1]=N*Xe,t[2]=N*Ke,t[3]=N*Ze,t[4]=N*(M*o+v*h+I*p-(A*o+D*h+R*p)),t[5]=N*(A*n+z*h+L*p-(M*n+B*h+V*p)),t[6]=N*(D*n+B*o+k*p-(v*n+z*o+d*p)),t[7]=N*(R*n+V*o+d*h-(I*n+L*o+k*h)),t[8]=N*(O*u+W*y+H*b-($*u+G*y+At*b)),t[9]=N*($*s+St*y+wt*b-(O*s+Tt*y+bt*b)),t[10]=N*(G*s+Tt*u+Et*b-(W*s+St*u+gt*b)),t[11]=N*(At*s+bt*u+gt*y-(H*s+wt*u+Et*y)),t[12]=N*(G*l+At*S+$*a-(H*S+O*a+W*l)),t[13]=N*(bt*S+O*i+Tt*l-(St*l+wt*S+$*i)),t[14]=N*(St*a+gt*S+W*i-(Et*S+G*i+Tt*a)),t[15]=N*(Et*l+H*i+wt*a-(bt*a+gt*l+At*i)),t}function wn(e,t,n){n=n||new w(16);const r=e[0],i=e[1],s=e[2],o=e[3],c=e[4+0],a=e[4+1],u=e[4+2],h=e[4+3],f=e[8+0],l=e[8+1],y=e[8+2],p=e[8+3],T=e[12+0],S=e[12+1],b=e[12+2],A=e[12+3],M=t[0],v=t[1],D=t[2],R=t[3],I=t[4+0],B=t[4+1],z=t[4+2],L=t[4+3],V=t[8+0],d=t[8+1],k=t[8+2],O=t[8+3],$=t[12+0],G=t[12+1],W=t[12+2],H=t[12+3];return n[0]=r*M+c*v+f*D+T*R,n[1]=i*M+a*v+l*D+S*R,n[2]=s*M+u*v+y*D+b*R,n[3]=o*M+h*v+p*D+A*R,n[4]=r*I+c*B+f*z+T*L,n[5]=i*I+a*B+l*z+S*L,n[6]=s*I+u*B+y*z+b*L,n[7]=o*I+h*B+p*z+A*L,n[8]=r*V+c*d+f*k+T*O,n[9]=i*V+a*d+l*k+S*O,n[10]=s*V+u*d+y*k+b*O,n[11]=o*V+h*d+p*k+A*O,n[12]=r*$+c*G+f*W+T*H,n[13]=i*$+a*G+l*W+S*H,n[14]=s*$+u*G+y*W+b*H,n[15]=o*$+h*G+p*W+A*H,n}function En(e,t,n){return n=n||jt(),e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11]),n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function gn(e,t){return t=t||q(),t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function In(e,t,n){n=n||q();const r=t*4;return n[0]=e[r+0],n[1]=e[r+1],n[2]=e[r+2],n}function Bn(e,t,n,r){r!==e&&(r=qt(e,r));const i=n*4;return r[i+0]=t[0],r[i+1]=t[1],r[i+2]=t[2],r}function _n(e,t,n,r,i){i=i||new w(16);const s=Math.tan(Math.PI*.5-.5*e),o=1/(n-r);return i[0]=s/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(n+r)*o,i[11]=-1,i[12]=0,i[13]=0,i[14]=n*r*o*2,i[15]=0,i}function Pn(e,t,n,r,i,s,o){return o=o||new w(16),o[0]=2/(t-e),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/(r-n),o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2/(i-s),o[11]=0,o[12]=(t+e)/(e-t),o[13]=(r+n)/(n-r),o[14]=(s+i)/(i-s),o[15]=1,o}function Rn(e,t,n,r,i,s,o){o=o||new w(16);const c=t-e,a=r-n,u=i-s;return o[0]=2*i/c,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*i/a,o[6]=0,o[7]=0,o[8]=(e+t)/c,o[9]=(r+n)/a,o[10]=s/u,o[11]=-1,o[12]=0,o[13]=0,o[14]=i*s/u,o[15]=0,o}let X,J,j;function Mn(e,t,n,r){return r=r||new w(16),X=X||q(),J=J||q(),j=j||q(),rt(Yt(e,t,j),j),rt(It(n,j,X),X),rt(It(j,X,J),J),r[0]=X[0],r[1]=X[1],r[2]=X[2],r[3]=0,r[4]=J[0],r[5]=J[1],r[6]=J[2],r[7]=0,r[8]=j[0],r[9]=j[1],r[10]=j[2],r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function vn(e,t){return t=t||new w(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Dn(e,t,n){n=n||new w(16);const r=t[0],i=t[1],s=t[2],o=e[0],c=e[1],a=e[2],u=e[3],h=e[1*4+0],f=e[1*4+1],l=e[1*4+2],y=e[1*4+3],p=e[2*4+0],T=e[2*4+1],S=e[2*4+2],b=e[2*4+3],A=e[3*4+0],M=e[3*4+1],v=e[3*4+2],D=e[3*4+3];return e!==n&&(n[0]=o,n[1]=c,n[2]=a,n[3]=u,n[4]=h,n[5]=f,n[6]=l,n[7]=y,n[8]=p,n[9]=T,n[10]=S,n[11]=b),n[12]=o*r+h*i+p*s+A,n[13]=c*r+f*i+T*s+M,n[14]=a*r+l*i+S*s+v,n[15]=u*r+y*i+b*s+D,n}function Fn(e,t){t=t||new w(16);const n=Math.cos(e),r=Math.sin(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zn(e,t,n){n=n||new w(16);const r=e[4],i=e[5],s=e[6],o=e[7],c=e[8],a=e[9],u=e[10],h=e[11],f=Math.cos(t),l=Math.sin(t);return n[4]=f*r+l*c,n[5]=f*i+l*a,n[6]=f*s+l*u,n[7]=f*o+l*h,n[8]=f*c-l*r,n[9]=f*a-l*i,n[10]=f*u-l*s,n[11]=f*h-l*o,e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n}function Nn(e,t){t=t||new w(16);const n=Math.cos(e),r=Math.sin(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Cn(e,t,n){n=n||new w(16);const r=e[0*4+0],i=e[0*4+1],s=e[0*4+2],o=e[0*4+3],c=e[2*4+0],a=e[2*4+1],u=e[2*4+2],h=e[2*4+3],f=Math.cos(t),l=Math.sin(t);return n[0]=f*r-l*c,n[1]=f*i-l*a,n[2]=f*s-l*u,n[3]=f*o-l*h,n[8]=f*c+l*r,n[9]=f*a+l*i,n[10]=f*u+l*s,n[11]=f*h+l*o,e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n}function Un(e,t){t=t||new w(16);const n=Math.cos(e),r=Math.sin(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ln(e,t,n){n=n||new w(16);const r=e[0*4+0],i=e[0*4+1],s=e[0*4+2],o=e[0*4+3],c=e[1*4+0],a=e[1*4+1],u=e[1*4+2],h=e[1*4+3],f=Math.cos(t),l=Math.sin(t);return n[0]=f*r+l*c,n[1]=f*i+l*a,n[2]=f*s+l*u,n[3]=f*o+l*h,n[4]=f*c-l*r,n[5]=f*a-l*i,n[6]=f*u-l*s,n[7]=f*h-l*o,e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n}function Vn(e,t,n){n=n||new w(16);let r=e[0],i=e[1],s=e[2];const o=Math.sqrt(r*r+i*i+s*s);r/=o,i/=o,s/=o;const c=r*r,a=i*i,u=s*s,h=Math.cos(t),f=Math.sin(t),l=1-h;return n[0]=c+(1-c)*h,n[1]=r*i*l+s*f,n[2]=r*s*l-i*f,n[3]=0,n[4]=r*i*l-s*f,n[5]=a+(1-a)*h,n[6]=i*s*l+r*f,n[7]=0,n[8]=r*s*l+i*f,n[9]=i*s*l-r*f,n[10]=u+(1-u)*h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function dn(e,t,n,r){r=r||new w(16);let i=t[0],s=t[1],o=t[2];const c=Math.sqrt(i*i+s*s+o*o);i/=c,s/=c,o/=c;const a=i*i,u=s*s,h=o*o,f=Math.cos(n),l=Math.sin(n),y=1-f,p=a+(1-a)*f,T=i*s*y+o*l,S=i*o*y-s*l,b=i*s*y-o*l,A=u+(1-u)*f,M=s*o*y+i*l,v=i*o*y+s*l,D=s*o*y-i*l,R=h+(1-h)*f,I=e[0],B=e[1],z=e[2],L=e[3],V=e[4],d=e[5],k=e[6],O=e[7],$=e[8],G=e[9],W=e[10],H=e[11];return r[0]=p*I+T*V+S*$,r[1]=p*B+T*d+S*G,r[2]=p*z+T*k+S*W,r[3]=p*L+T*O+S*H,r[4]=b*I+A*V+M*$,r[5]=b*B+A*d+M*G,r[6]=b*z+A*k+M*W,r[7]=b*L+A*O+M*H,r[8]=v*I+D*V+R*$,r[9]=v*B+D*d+R*G,r[10]=v*z+D*k+R*W,r[11]=v*L+D*O+R*H,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r}function kn(e,t){return t=t||new w(16),t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function On(e,t,n){n=n||new w(16);const r=t[0],i=t[1],s=t[2];return n[0]=r*e[0*4+0],n[1]=r*e[0*4+1],n[2]=r*e[0*4+2],n[3]=r*e[0*4+3],n[4]=i*e[1*4+0],n[5]=i*e[1*4+1],n[6]=i*e[1*4+2],n[7]=i*e[1*4+3],n[8]=s*e[2*4+0],n[9]=s*e[2*4+1],n[10]=s*e[2*4+2],n[11]=s*e[2*4+3],e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n}function $n(e,t,n){n=n||q();const r=t[0],i=t[1],s=t[2],o=r*e[0*4+3]+i*e[1*4+3]+s*e[2*4+3]+e[3*4+3];return n[0]=(r*e[0*4+0]+i*e[1*4+0]+s*e[2*4+0]+e[3*4+0])/o,n[1]=(r*e[0*4+1]+i*e[1*4+1]+s*e[2*4+1]+e[3*4+1])/o,n[2]=(r*e[0*4+2]+i*e[1*4+2]+s*e[2*4+2]+e[3*4+2])/o,n}function Gn(e,t,n){n=n||q();const r=t[0],i=t[1],s=t[2];return n[0]=r*e[0*4+0]+i*e[1*4+0]+s*e[2*4+0],n[1]=r*e[0*4+1]+i*e[1*4+1]+s*e[2*4+1],n[2]=r*e[0*4+2]+i*e[1*4+2]+s*e[2*4+2],n}function Wn(e,t,n){n=n||q();const r=Xt(e),i=t[0],s=t[1],o=t[2];return n[0]=i*r[0*4+0]+s*r[0*4+1]+o*r[0*4+2],n[1]=i*r[1*4+0]+s*r[1*4+1]+o*r[1*4+2],n[2]=i*r[2*4+0]+s*r[2*4+1]+o*r[2*4+2],n}var Q=Object.freeze({__proto__:null,axisRotate:dn,axisRotation:Vn,copy:qt,create:Tn,frustum:Rn,getAxis:In,getTranslation:gn,identity:jt,inverse:Xt,lookAt:Mn,multiply:wn,negate:Sn,ortho:Pn,perspective:_n,rotateX:zn,rotateY:Cn,rotateZ:Ln,rotationX:Fn,rotationY:Nn,rotationZ:Un,scale:On,scaling:kn,setAxis:Bn,setDefaultType:An,setTranslation:En,transformDirection:Gn,transformNormal:Wn,transformPoint:$n,translate:Dn,translation:vn,transpose:bn});const Bt=5120,tt=5121,_t=5122,Pt=5123,Rt=5124,Mt=5125,vt=5126,Hn=32819,Yn=32820,qn=33635,jn=5131,Xn=33640,Kn=35899,Zn=35902,Jn=36269,Qn=34042,Kt={};{const e=Kt;e[Bt]=Int8Array,e[tt]=Uint8Array,e[_t]=Int16Array,e[Pt]=Uint16Array,e[Rt]=Int32Array,e[Mt]=Uint32Array,e[vt]=Float32Array,e[Hn]=Uint16Array,e[Yn]=Uint16Array,e[qn]=Uint16Array,e[jn]=Uint16Array,e[Xn]=Uint32Array,e[Kn]=Uint32Array,e[Zn]=Uint32Array,e[Jn]=Uint32Array,e[Qn]=Uint32Array}function Zt(e){if(e instanceof Int8Array)return Bt;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return tt;if(e instanceof Int16Array)return _t;if(e instanceof Uint16Array)return Pt;if(e instanceof Int32Array)return Rt;if(e instanceof Uint32Array)return Mt;if(e instanceof Float32Array)return vt;throw new Error("unsupported typed array type")}function Jt(e){if(e===Int8Array)return Bt;if(e===Uint8Array||e===Uint8ClampedArray)return tt;if(e===Int16Array)return _t;if(e===Uint16Array)return Pt;if(e===Int32Array)return Rt;if(e===Uint32Array)return Mt;if(e===Float32Array)return vt;throw new Error("unsupported typed array type")}function tr(e){const t=Kt[e];if(!t)throw new Error("unknown gl type");return t}const Dt=typeof SharedArrayBuffer<"u"?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function er(...e){console.error(...e)}const Qt=new Map;function te(e,t){if(!e||typeof e!="object")return!1;let n=Qt.get(t);n||(n=new WeakMap,Qt.set(t,n));let r=n.get(e);if(r===void 0){const i=Object.prototype.toString.call(e);r=i.substring(8,i.length-1)===t,n.set(e,r)}return r}function nr(e,t){return typeof WebGLBuffer<"u"&&te(t,"WebGLBuffer")}function ee(e,t){return typeof WebGLTexture<"u"&&te(t,"WebGLTexture")}const ne=35044,Y=34962,rr=34963,ir=34660,sr=5120,or=5121,cr=5122,ar=5123,ur=5124,fr=5125,re=5126,ie={attribPrefix:""};function se(e,t,n,r,i){e.bindBuffer(t,n),e.bufferData(t,r,i||ne)}function oe(e,t,n,r){if(nr(e,t))return t;n=n||Y;const i=e.createBuffer();return se(e,n,i,t,r),i}function ce(e){return e==="indices"}function hr(e){return e===Int8Array||e===Uint8Array}function lr(e){return e.length?e:e.data}const xr=/coord|texture/i,yr=/color|colour/i;function pr(e,t){let n;if(xr.test(e)?n=2:yr.test(e)?n=4:n=3,t%n>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${n} but ${t} values is not evenly divisible by ${n}. You should specify it.`);return n}function mr(e,t,n){return e.numComponents||e.size||pr(t,n||lr(e).length)}function Ft(e,t){if(Dt(e))return e;if(Dt(e.data))return e.data;Array.isArray(e)&&(e={data:e});let n=e.type?zt(e.type):void 0;return n||(ce(t)?n=Uint16Array:n=Float32Array),new n(e.data)}function Ar(e){return typeof e=="number"?e:e?Jt(e):re}function zt(e){return typeof e=="number"?tr(e):e||Float32Array}function Sr(e,t){return{buffer:t.buffer,numValues:2*3*4,type:Ar(t.type),arrayType:zt(t.type)}}function Tr(e,t){const n=t.data||t,r=zt(t.type),i=n*r.BYTES_PER_ELEMENT,s=e.createBuffer();return e.bindBuffer(Y,s),e.bufferData(Y,i,t.drawType||ne),{buffer:s,numValues:n,type:Jt(r),arrayType:r}}function br(e,t,n){const r=Ft(t,n);return{arrayType:r.constructor,buffer:oe(e,r,void 0,t.drawType),type:Zt(r),numValues:0}}function wr(e,t){const n={};return Object.keys(t).forEach(function(r){if(!ce(r)){const i=t[r],s=i.attrib||i.name||i.attribName||ie.attribPrefix+r;if(i.value){if(!Array.isArray(i.value)&&!Dt(i.value))throw new Error("array.value is not array or typedarray");n[s]={value:i.value}}else{let o;i.buffer&&i.buffer instanceof WebGLBuffer?o=Sr:typeof i=="number"||typeof i.data=="number"?o=Tr:o=br;const{buffer:c,type:a,numValues:u,arrayType:h}=o(e,i,r),f=i.normalize!==void 0?i.normalize:hr(h),l=mr(i,r,u);n[s]={buffer:c,numComponents:l,type:a,normalize:f,stride:i.stride||0,offset:i.offset||0,divisor:i.divisor===void 0?void 0:i.divisor,drawType:i.drawType}}}}),e.bindBuffer(Y,null),n}function ae(e,t,n,r){n=Ft(n),r!==void 0?(e.bindBuffer(Y,t.buffer),e.bufferSubData(Y,r,n)):se(e,Y,t.buffer,n,t.drawType)}function Er(e,t){return t===sr||t===or?1:t===cr||t===ar?2:t===ur||t===fr||t===re?4:0}const Nt=["position","positions","a_position"];function gr(e,t){let n,r;for(r=0;r<Nt.length&&(n=Nt[r],!(n in t||(n=ie.attribPrefix+n,n in t)));++r);r===Nt.length&&(n=Object.keys(t)[0]);const i=t[n];if(!i.buffer)return 1;e.bindBuffer(Y,i.buffer);const s=e.getBufferParameter(Y,ir);e.bindBuffer(Y,null);const o=Er(e,i.type),c=s/o,a=i.numComponents||i.size,u=c/a;if(u%1!==0)throw new Error(`numComponents ${a} not correct for length ${length}`);return u}function Ir(e,t,n){const r=wr(e,t),i=Object.assign({},n||{});i.attribs=Object.assign({},n?n.attribs:{},r);const s=t.indices;if(s){const o=Ft(s,"indices");i.indices=oe(e,o,rr),i.numElements=o.length,i.elementType=Zt(o)}else i.numElements||(i.numElements=gr(e,i.attribs));return i}function Ct(e){return!!e.texStorage2D}const Br=function(){const e={},t={};function n(r){const i=r.constructor.name;if(!e[i]){for(const s in r)if(typeof r[s]=="number"){const o=t[r[s]];t[r[s]]=o?`${o} | ${s}`:s}e[i]=!0}}return function(i,s){return n(i),t[s]||(typeof s=="number"?`0x${s.toString(16)}`:s)}}(),Ut=er;function ue(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}const it=33984,st=34962,_r=34963,Pr=35713,Rr=35714,Mr=35632,vr=35633,Dr=35981,fe=35718,Fr=35721,zr=35971,Nr=35382,Cr=35396,Ur=35398,Lr=35392,Vr=35395,ot=5126,he=35664,le=35665,xe=35666,Lt=5124,ye=35667,pe=35668,me=35669,Ae=35670,Se=35671,Te=35672,be=35673,we=35674,Ee=35675,ge=35676,dr=35678,kr=35680,Or=35679,$r=35682,Gr=35685,Wr=35686,Hr=35687,Yr=35688,qr=35689,jr=35690,Xr=36289,Kr=36292,Zr=36293,Vt=5125,Ie=36294,Be=36295,_e=36296,Jr=36298,Qr=36299,ti=36300,ei=36303,ni=36306,ri=36307,ii=36308,si=36311,ct=3553,at=34067,dt=32879,ut=35866,m={};function Pe(e,t){return m[t].bindPoint}function oi(e,t){return function(n){e.uniform1f(t,n)}}function ci(e,t){return function(n){e.uniform1fv(t,n)}}function ai(e,t){return function(n){e.uniform2fv(t,n)}}function ui(e,t){return function(n){e.uniform3fv(t,n)}}function fi(e,t){return function(n){e.uniform4fv(t,n)}}function Re(e,t){return function(n){e.uniform1i(t,n)}}function Me(e,t){return function(n){e.uniform1iv(t,n)}}function ve(e,t){return function(n){e.uniform2iv(t,n)}}function De(e,t){return function(n){e.uniform3iv(t,n)}}function Fe(e,t){return function(n){e.uniform4iv(t,n)}}function hi(e,t){return function(n){e.uniform1ui(t,n)}}function li(e,t){return function(n){e.uniform1uiv(t,n)}}function xi(e,t){return function(n){e.uniform2uiv(t,n)}}function yi(e,t){return function(n){e.uniform3uiv(t,n)}}function pi(e,t){return function(n){e.uniform4uiv(t,n)}}function mi(e,t){return function(n){e.uniformMatrix2fv(t,!1,n)}}function Ai(e,t){return function(n){e.uniformMatrix3fv(t,!1,n)}}function Si(e,t){return function(n){e.uniformMatrix4fv(t,!1,n)}}function Ti(e,t){return function(n){e.uniformMatrix2x3fv(t,!1,n)}}function bi(e,t){return function(n){e.uniformMatrix3x2fv(t,!1,n)}}function wi(e,t){return function(n){e.uniformMatrix2x4fv(t,!1,n)}}function Ei(e,t){return function(n){e.uniformMatrix4x2fv(t,!1,n)}}function gi(e,t){return function(n){e.uniformMatrix3x4fv(t,!1,n)}}function Ii(e,t){return function(n){e.uniformMatrix4x3fv(t,!1,n)}}function C(e,t,n,r){const i=Pe(e,t);return Ct(e)?function(s){let o,c;!s||ee(e,s)?(o=s,c=null):(o=s.texture,c=s.sampler),e.uniform1i(r,n),e.activeTexture(it+n),e.bindTexture(i,o),e.bindSampler(n,c)}:function(s){e.uniform1i(r,n),e.activeTexture(it+n),e.bindTexture(i,s)}}function U(e,t,n,r,i){const s=Pe(e,t),o=new Int32Array(i);for(let c=0;c<i;++c)o[c]=n+c;return Ct(e)?function(c){e.uniform1iv(r,o),c.forEach(function(a,u){e.activeTexture(it+o[u]);let h,f;!a||ee(e,a)?(h=a,f=null):(h=a.texture,f=a.sampler),e.bindSampler(n,f),e.bindTexture(s,h)})}:function(c){e.uniform1iv(r,o),c.forEach(function(a,u){e.activeTexture(it+o[u]),e.bindTexture(s,a)})}}m[ot]={Type:Float32Array,size:4,setter:oi,arraySetter:ci},m[he]={Type:Float32Array,size:8,setter:ai,cols:2},m[le]={Type:Float32Array,size:12,setter:ui,cols:3},m[xe]={Type:Float32Array,size:16,setter:fi,cols:4},m[Lt]={Type:Int32Array,size:4,setter:Re,arraySetter:Me},m[ye]={Type:Int32Array,size:8,setter:ve,cols:2},m[pe]={Type:Int32Array,size:12,setter:De,cols:3},m[me]={Type:Int32Array,size:16,setter:Fe,cols:4},m[Vt]={Type:Uint32Array,size:4,setter:hi,arraySetter:li},m[Ie]={Type:Uint32Array,size:8,setter:xi,cols:2},m[Be]={Type:Uint32Array,size:12,setter:yi,cols:3},m[_e]={Type:Uint32Array,size:16,setter:pi,cols:4},m[Ae]={Type:Uint32Array,size:4,setter:Re,arraySetter:Me},m[Se]={Type:Uint32Array,size:8,setter:ve,cols:2},m[Te]={Type:Uint32Array,size:12,setter:De,cols:3},m[be]={Type:Uint32Array,size:16,setter:Fe,cols:4},m[we]={Type:Float32Array,size:32,setter:mi,rows:2,cols:2},m[Ee]={Type:Float32Array,size:48,setter:Ai,rows:3,cols:3},m[ge]={Type:Float32Array,size:64,setter:Si,rows:4,cols:4},m[Gr]={Type:Float32Array,size:32,setter:Ti,rows:2,cols:3},m[Wr]={Type:Float32Array,size:32,setter:wi,rows:2,cols:4},m[Hr]={Type:Float32Array,size:48,setter:bi,rows:3,cols:2},m[Yr]={Type:Float32Array,size:48,setter:gi,rows:3,cols:4},m[qr]={Type:Float32Array,size:64,setter:Ei,rows:4,cols:2},m[jr]={Type:Float32Array,size:64,setter:Ii,rows:4,cols:3},m[dr]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:ct},m[kr]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:at},m[Or]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:dt},m[$r]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:ct},m[Xr]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:ut},m[Kr]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:ut},m[Zr]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:at},m[Jr]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:ct},m[Qr]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:dt},m[ti]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:at},m[ei]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:ut},m[ni]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:ct},m[ri]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:dt},m[ii]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:at},m[si]={Type:null,size:0,setter:C,arraySetter:U,bindPoint:ut};function ft(e,t){return function(n){if(n.value)switch(e.disableVertexAttribArray(t),n.value.length){case 4:e.vertexAttrib4fv(t,n.value);break;case 3:e.vertexAttrib3fv(t,n.value);break;case 2:e.vertexAttrib2fv(t,n.value);break;case 1:e.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(st,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents||n.size,n.type||ot,n.normalize||!1,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function K(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4iv(t,n.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(st,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||Lt,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function ht(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4uiv(t,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(st,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||Vt,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function kt(e,t,n){const r=n.size,i=n.count;return function(s){e.bindBuffer(st,s.buffer);const o=s.size||s.numComponents||r,c=o/i,a=s.type||ot,h=m[a].size*o,f=s.normalize||!1,l=s.offset||0,y=h/i;for(let p=0;p<i;++p)e.enableVertexAttribArray(t+p),e.vertexAttribPointer(t+p,c,a,f,h,l+y*p),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+p,s.divisor||0)}}const P={};P[ot]={size:4,setter:ft},P[he]={size:8,setter:ft},P[le]={size:12,setter:ft},P[xe]={size:16,setter:ft},P[Lt]={size:4,setter:K},P[ye]={size:8,setter:K},P[pe]={size:12,setter:K},P[me]={size:16,setter:K},P[Vt]={size:4,setter:ht},P[Ie]={size:8,setter:ht},P[Be]={size:12,setter:ht},P[_e]={size:16,setter:ht},P[Ae]={size:4,setter:K},P[Se]={size:8,setter:K},P[Te]={size:12,setter:K},P[be]={size:16,setter:K},P[we]={size:4,setter:kt,count:2},P[Ee]={size:9,setter:kt,count:3},P[ge]={size:16,setter:kt,count:4};const Bi=/ERROR:\s*\d+:(\d+)/gi;function _i(e,t="",n=0){const r=[...t.matchAll(Bi)],i=new Map(r.map((s,o)=>{const c=parseInt(s[1]),a=r[o+1],u=a?a.index:t.length,h=t.substring(s.index,u);return[c-1,h]}));return e.split(`
`).map((s,o)=>{const c=i.get(o);return`${o+1+n}: ${s}${c?`

^^^ ${c}`:""}`}).join(`
`)}const ze=/^[ \t]*\n/;function Ne(e){let t=0;return ze.test(e)&&(t=1,e=e.replace(ze,"")),{lineOffset:t,shaderSource:e}}function Pi(e,t){return e.errorCallback(t),e.callback&&setTimeout(()=>{e.callback(`${t}
${e.errors.join(`
`)}`)}),null}function Ri(e,t,n,r){if(r=r||Ut,!e.getShaderParameter(n,Pr)){const s=e.getShaderInfoLog(n),{lineOffset:o,shaderSource:c}=Ne(e.getShaderSource(n)),a=`${_i(c,s,o)}
Error compiling ${Br(e,t)}: ${s}`;return r(a),a}return""}function Ot(e,t,n){let r,i,s;if(typeof t=="function"&&(n=t,t=void 0),typeof e=="function")n=e,e=void 0;else if(e&&!Array.isArray(e)){const u=e;n=u.errorCallback,e=u.attribLocations,r=u.transformFeedbackVaryings,i=u.transformFeedbackMode,s=u.callback}const o=n||Ut,c=[],a={errorCallback(u,...h){c.push(u),o(u,...h)},transformFeedbackVaryings:r,transformFeedbackMode:i,callback:s,errors:c};{let u={};Array.isArray(e)?e.forEach(function(h,f){u[h]=t?t[f]:f}):u=e||{},a.attribLocations=u}return a}const Mi=["VERTEX_SHADER","FRAGMENT_SHADER"];function vi(e,t){if(t.indexOf("frag")>=0)return Mr;if(t.indexOf("vert")>=0)return vr}function Di(e,t,n){const r=e.getAttachedShaders(t);for(const i of r)n.has(i)&&e.deleteShader(i);e.deleteProgram(t)}const Fi=(e=0)=>new Promise(t=>setTimeout(t,e));function zi(e,t,n){const r=e.createProgram(),{attribLocations:i,transformFeedbackVaryings:s,transformFeedbackMode:o}=Ot(n);for(let c=0;c<t.length;++c){let a=t[c];if(typeof a=="string"){const u=ue(a),h=u?u.text:a;let f=e[Mi[c]];u&&u.type&&(f=vi(e,u.type)||f),a=e.createShader(f),e.shaderSource(a,Ne(h).shaderSource),e.compileShader(a),e.attachShader(r,a)}}Object.entries(i).forEach(([c,a])=>e.bindAttribLocation(r,a,c));{let c=s;c&&(c.attribs&&(c=c.attribs),Array.isArray(c)||(c=Object.keys(c)),e.transformFeedbackVaryings(r,c,o||Dr))}return e.linkProgram(r),r}function Ni(e,t,n,r,i){const s=Ot(n,r,i),o=new Set(t),c=zi(e,t,s);function a(u,h){const f=Ui(u,h,s.errorCallback);return f&&Di(u,h,o),f}if(s.callback){Ci(e,c).then(()=>{const u=a(e,c);s.callback(u,u?void 0:c)});return}return a(e,c)?void 0:c}async function Ci(e,t){const n=e.getExtension("KHR_parallel_shader_compile"),r=n?(s,o)=>s.getProgramParameter(o,n.COMPLETION_STATUS_KHR):()=>!0;let i=0;do await Fi(i),i=1e3/60;while(!r(e,t))}function Ui(e,t,n){if(n=n||Ut,!e.getProgramParameter(t,Rr)){const i=e.getProgramInfoLog(t);n(`Error in program linking: ${i}`);const o=e.getAttachedShaders(t).map(c=>Ri(e,e.getShaderParameter(c,e.SHADER_TYPE),c,n));return`${i}
${o.filter(c=>c).join(`
`)}`}}function Li(e,t,n,r,i){return Ni(e,t,n,r,i)}function Ce(e){const t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}const Vi=/(\.|\[|]|\w+)/g,di=e=>e>="0"&&e<="9";function ki(e,t,n,r){const i=e.split(Vi).filter(c=>c!=="");let s=0,o="";for(;;){const c=i[s++];o+=c;const a=di(c[0]),u=a?parseInt(c):c;if(a&&(o+=i[s++]),s===i.length){n[u]=t;break}else{const f=i[s++],l=f==="[",y=n[u]||(l?[]:{});n[u]=y,n=y,r[o]=r[o]||function(p){return function(T){Ue(p,T)}}(y),o+=f}}}function Oi(e,t){let n=0;function r(c,a,u){const h=a.name.endsWith("[0]"),f=a.type,l=m[f];if(!l)throw new Error(`unknown type: 0x${f.toString(16)}`);let y;if(l.bindPoint){const p=n;n+=a.size,h?y=l.arraySetter(e,f,p,u,a.size):y=l.setter(e,f,p,u,a.size)}else l.arraySetter&&h?y=l.arraySetter(e,u):y=l.setter(e,u);return y.location=u,y}const i={},s={},o=e.getProgramParameter(t,fe);for(let c=0;c<o;++c){const a=e.getActiveUniform(t,c);if(Ce(a))continue;let u=a.name;u.endsWith("[0]")&&(u=u.substr(0,u.length-3));const h=e.getUniformLocation(t,a.name);if(h){const f=r(t,a,h);i[u]=f,ki(u,f,s,i)}}return i}function $i(e,t){const n={},r=e.getProgramParameter(t,zr);for(let i=0;i<r;++i){const s=e.getTransformFeedbackVarying(t,i);n[s.name]={index:i,type:s.type,size:s.size}}return n}function Gi(e,t){const n=e.getProgramParameter(t,fe),r=[],i=[];for(let c=0;c<n;++c){i.push(c),r.push({});const a=e.getActiveUniform(t,c);r[c].name=a.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(c){const a=c[0],u=c[1];e.getActiveUniforms(t,i,e[a]).forEach(function(h,f){r[f][u]=h})});const s={},o=e.getProgramParameter(t,Nr);for(let c=0;c<o;++c){const a=e.getActiveUniformBlockName(t,c),u={index:e.getUniformBlockIndex(t,a),usedByVertexShader:e.getActiveUniformBlockParameter(t,c,Cr),usedByFragmentShader:e.getActiveUniformBlockParameter(t,c,Ur),size:e.getActiveUniformBlockParameter(t,c,Lr),uniformIndices:e.getActiveUniformBlockParameter(t,c,Vr)};u.used=u.usedByVertexShader||u.usedByFragmentShader,s[a]=u}return{blockSpecs:s,uniformData:r}}function Ue(e,t){for(const n in t){const r=e[n];typeof r=="function"?r(t[n]):Ue(e[n],t[n])}}function lt(e,...t){const n=e.uniformSetters||e,r=t.length;for(let i=0;i<r;++i){const s=t[i];if(Array.isArray(s)){const o=s.length;for(let c=0;c<o;++c)lt(n,s[c])}else for(const o in s){const c=n[o];c&&c(s[o])}}}function Wi(e,t){const n={},r=e.getProgramParameter(t,Fr);for(let i=0;i<r;++i){const s=e.getActiveAttrib(t,i);if(Ce(s))continue;const o=e.getAttribLocation(t,s.name),c=P[s.type],a=c.setter(e,o,c);a.location=o,n[s.name]=a}return n}function Hi(e,t){for(const n in t){const r=e[n];r&&r(t[n])}}function Le(e,t,n){n.vertexArrayObject?e.bindVertexArray(n.vertexArrayObject):(Hi(t.attribSetters||t,n.attribs),n.indices&&e.bindBuffer(_r,n.indices))}function Ve(e,t){const n=Oi(e,t),r=Wi(e,t),i={program:t,uniformSetters:n,attribSetters:r};return Ct(e)&&(i.uniformBlockSpec=Gi(e,t),i.transformFeedbackInfo=$i(e,t)),i}const Yi=/\s|{|}|;/;function qi(e,t,n,r,i){const s=Ot(n,r,i),o=[];if(t=t.map(function(u){if(!Yi.test(u)){const h=ue(u);if(h)u=h.text;else{const f=`no element with id: ${u}`;s.errorCallback(f),o.push(f)}}return u}),o.length)return Pi(s,"");const c=s.callback;c&&(s.callback=(u,h)=>{c(u,u?void 0:Ve(e,h))});const a=Li(e,t,s);return a?Ve(e,a):null}const ji=4,de=5123;function ke(e,t,n,r,i,s){n=n===void 0?ji:n;const o=t.indices,c=t.elementType,a=r===void 0?t.numElements:r;i=i===void 0?0:i,c||o?s!==void 0?e.drawElementsInstanced(n,a,c===void 0?de:t.elementType,i,s):e.drawElements(n,a,c===void 0?de:t.elementType,i):s!==void 0?e.drawArraysInstanced(n,i,a,s):e.drawArrays(n,i,a)}function Xi(e,t){t=t||1,t=Math.max(0,t);const n=e.clientWidth*t|0,r=e.clientHeight*t|0;return e.width!==n||e.height!==r?(e.width=n,e.height=r,!0):!1}const Oe={vertexShader:`
attribute vec2 position;
attribute vec4 color;

varying vec4 v_color;

uniform mat4 viewProjectionMatrix;
uniform mat4 modelMatrix;

void main() {
  gl_Position = viewProjectionMatrix * modelMatrix *  vec4(position.x, position.y, 0.0, 1.0);
  v_color = color;
}
`,fragmentShader:`
precision mediump float;

varying vec4 v_color;

void main() {
  // vec2 uv = gl_FragCoord.xy / resolution;

  gl_FragColor = v_color;
}

  `};function Ki(e,t){return new x(e,t)}class x{x;y;constructor(t,n){this.x=t,this.y=n}static zero=()=>new x(0,0);static up=()=>new x(0,-1);static down=()=>new x(0,1);static left=()=>new x(-1,0);static right=()=>new x(1,0);add(t,n){return t instanceof x?(this.x+=t.x,this.y+=t.y):n?(this.x+=t,this.y+=n):(this.x+=t,this.y+=t),this}static add(t,n){return new x(t.x+n.x,t.y+n.y)}mult(t,n){return t instanceof x?(this.x*=t.x,this.y*=t.y):n?(this.x*=t,this.y*=n):(this.x*=t,this.y*=t),this}static mult(t,n){return n instanceof x?new x(t.x*n.x,t.y*n.y):new x(t.x*n,t.y*n)}sub(t,n){return t instanceof x?(this.x-=t.x,this.y-=t.y):n?(this.x-=t,this.y-=n):(this.x-=t,this.y-=t),this}static sub(t,n){return new x(t.x-n.x,t.y-n.y)}div(t,n){return t instanceof x?(this.x/=t.x,this.y/=t.y):n?(this.x/=t,this.y/=n):(this.x/=t,this.y/=t),this}static div(t,n){return new x(t.x/n.x,t.y/n.y)}set(t,n){return t instanceof x?(this.x=t.x,this.y=t.y):n?(this.x=t,this.y=n):(this.x=t,this.y=t),this}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}static mag(t){return Math.sqrt(t.x*t.x+t.y*t.y)}magSq(){return this.x*this.x+this.y*this.y}static magSq(t){return t.x*t.x+t.y*t.y}setMag(t){let n=this.mag();return this.x*=t/n,this.y*=t/n,this}normalize(){return this.setMag(1),this}limit(t){return this.mag()>t&&this.setMag(t),this}heading(){return Math.atan2(this.y,this.x)}rotate(t){let n=Math.cos(t),r=Math.sin(t),i=n*this.x-r*this.y,s=n*this.y+r*this.x;return this.x=i,this.y=s,this}rotateAboutAxis(t,n){return this.sub(n).rotate(t).add(n),this}dot(t){return t.x*this.x+t.y*this.y}static dot(t,n){return t.x*n.x+t.y*n.y}cross(t){return this.x*t.y-this.y*t.x}static cross(t,n){return t.x*n.y-t.y*n.x}dist(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}static dist(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))}lerp(t,n){let r=t.x-this.x,i=t.y-this.y;return this.x+=n*r,this.y+=n*i,this}static angleBetween(t,n){return Math.atan2(t.x*n.y-t.y*n.x,t.x*n.x+t.y*n.y)}copy(){return new x(this.x,this.y)}}class E{pos;color;constructor(t,n){this.pos=t,this.color=n}}function Z(e,t,n,r,i){return r+(e-t)*((i-r)/(n-t))}function et(e,t,n){const r=x.sub(t,e).normalize().mult(n/2).rotate(Math.PI/2).add(e),i=x.sub(t,e).normalize().mult(n/2).rotate(-Math.PI/2).add(e);return[r,i]}function $t(e,t,n){return et(e.pos,t.pos,n).map(r=>new E(r,e.color))}function $e(e,t){const n=e.y-t.y,r=t.x-e.x,i=e.x*t.y-t.x*e.y;return{a:n,b:r,c:i}}function xt(e,t){const n=-e.b,r=e.a,i=-n*t.x-r*t.y;return{a:n,b:r,c:i}}function yt(e,t){const n=e.a,r=e.b,i=e.c+t*Math.sqrt(n*n+r*r);return{a:n,b:r,c:i}}function pt(e,t){const n=(e.b*t.c-t.b*e.c)/(e.a*t.b-t.a*e.b),r=(t.a*e.c-e.a*t.c)/(e.a*t.b-t.a*e.b);return new x(n,r)}function Ge(e,t,n,r,i=60){const s=e.pos,o=t.pos,c=n.pos,a=(180-i)*(Math.PI/180),u=x.angleBetween(x.sub(t.pos,e.pos),x.sub(n.pos,t.pos));if(Math.abs(u)<=.001)return{vertices:$t(t,n,r),indices:[0,1,2,1,2,3]};const h=$e(e.pos,t.pos),f=$e(t.pos,n.pos),l=yt(h,-r/2),y=yt(h,r/2),p=yt(f,-r/2),T=yt(f,r/2);let S=pt(l,p),b=pt(y,T);if(u<a&&u>-a)return{vertices:[new E(S,t.color),new E(b,t.color)],indices:[0,1,2,1,2,3]};if(u<=-a){let[A,M]=et(o,s,r),[v,D]=et(o,c,r);const R=x.sub(o,b).magSq(),I=x.sub(o,s).magSq(),B=x.sub(o,c).magSq();if(R>I||R>B){const z=B>I?xt(h,s):xt(f,c);b=pt(z,B>I?T:y)}return{vertices:[new E(M,t.color),new E(v,t.color),new E(b,t.color)],indices:[0,1,2,1,2,4,2,3,4],right:!0}}else{const[A,M]=et(t.pos,e.pos,r),[v,D]=et(t.pos,n.pos,r),R=x.sub(o,S).magSq(),I=x.sub(o,s).magSq(),B=x.sub(o,c).magSq();if(R>I||R>B){const z=B>I?xt(h,s):xt(f,c);S=pt(z,B>I?p:l)}return{vertices:[new E(A,t.color),new E(S,t.color),new E(D,t.color)],indices:[0,1,2,0,2,3,2,3,4],right:!1}}}class We{zoom=1;pos=new x(0,0);displaySize=new x(0,0);aspect=1;matrix=Q.identity();constructor(t){this.setDisplaySize(t)}translate(t){this.pos=this.pos.add(t),this.calculateMatrix()}setZoom(t){this.zoom=t,this.calculateMatrix()}setDisplaySize(t){this.displaySize=t,this.calculateAspectRatio(),this.calculateMatrix()}calculateAspectRatio(){this.aspect=this.displaySize.x/this.displaySize.y}calculateMatrix(){const t=this.displaySize.y/this.zoom/2;this.matrix=Q.translate(Q.ortho(-this.aspect*t,this.aspect*t,1*t,-1*t,-1,1),mn.create(-this.pos.x,-this.pos.y))}screenSpaceToWorldSpace(t){const n=window.innerHeight/this.zoom/2,r=Z(t.x,0,window.innerWidth,-this.aspect*n,this.aspect*n)+this.pos.x,i=Z(t.y,0,window.innerHeight,-1*n,1*n)+this.pos.y;return new x(r,i)}worldSpaceToScreenSpace(t){const n=window.innerHeight/this.zoom,r=Z(t.x,-this.aspect*n+this.pos.x,this.aspect*n+this.pos.x,0,window.innerWidth),i=Z(t.y,-1*n+this.pos.y,1*n+this.pos.y,0,window.innerHeight);return new x(r,i)}getMatrix(){return this.matrix}}class mt{positions;colors;indices;bufferInfo;currentVertices=0;currentIndices=0;vertexCapacity=0;indexCapacity=0;constructor(t,n){if(n.positions&&n.colors&&n.indices)this.positions=n.positions,this.colors=n.colors,this.indices=n.indices;else if(n.numVertices)this.positions=new Float32Array(n.numVertices*2),this.colors=new Uint8Array(n.numVertices*4),this.indices=new Uint16Array(n.numIndices?n.numIndices:n.numVertices*3);else throw new Error("Invalid BufferDataOptions! Must provide positions, colors, and indices arrays, or specify numVertices");this.vertexCapacity=this.positions.length/2,this.indexCapacity=this.indices.length;const i=(n.type?n.type:"dynamic")==="dynamic"?t.DYNAMIC_DRAW:t.STATIC_DRAW;this.bufferInfo=Ir(t,{position:{numComponents:2,data:this.positions,drawType:i},color:{numComponents:4,data:this.colors,drawType:i},indices:{numComponents:3,data:this.indices,drawType:i}})}addVertex(t){this.positions[this.currentVertices*2+0]=t.pos.x,this.positions[this.currentVertices*2+1]=t.pos.y;for(let n=0;n<4;n++)this.colors[this.currentVertices*4+n]=t.color.array()[n];this.currentVertices++}addIndex(t){for(let n=0;n<t.length;n++)this.indices[this.currentIndices+n]=t[n]+this.currentVertices;this.currentIndices+=t.length}updateBufferData(t){ae(t,this.bufferInfo.attribs.position,this.positions),ae(t,this.bufferInfo.attribs.color,this.colors),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.bufferInfo.indices),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.DYNAMIC_DRAW)}fill(){this.positions.fill(0,this.currentVertices*2),this.colors.fill(0,this.currentVertices*4),this.indices.fill(0,this.currentIndices)}resetCount(){this.currentVertices=0,this.currentIndices=0}}class nt{translation;rotation;scaling;transformed=!1;constructor(){this.translation=new x(0,0),this.rotation=0,this.scaling=new x(1,1)}copy(){const t=new nt;return t.translation=this.translation.copy(),t.rotation=this.rotation,t.scaling=this.scaling.copy(),t.transformed=this.transformed,t}translate(t){this.translation.add(t),this.transformed=!0}setTranslation(t){this.translation=t,this.transformed=!0}rotate(t){this.rotation+=t,this.transformed=!0}setRotation(t){this.rotation=t,this.transformed=!0}scale(t){this.scaling.mult(t),this.transformed=!0}setScale(t){this.scaling=t,this.transformed=!0}resetTransforms(){this.translation=new x(0,0),this.rotation=0,this.scaling=new x(1,1),this.transformed=!1}transformVertices(t){return this.transformed?t.map(n=>new E(n.pos.copy().rotate(this.rotation).mult(this.scaling).add(this.translation),n.color)):t}getMatrix(){return Q.translate(Q.scale(Q.rotateZ(Q.identity(),this.rotation),[this.scaling.x,this.scaling.y,1]),[this.translation.x,this.translation.y,0])}}class Gt{gl;id=-1;transform;constructor(t){this.gl=t,this.transform=new nt}addVerticesAndIndices(t,n){}update(){}render(t){}reset(){}}class He extends Gt{buffers=[];bufferSize;currentBufferIndex=-1;constructor(t,n){super(t),this.bufferSize=n.bufferSize,this.addBuffer()}addVerticesAndIndices(t,n){(this.buffers[this.currentBufferIndex].currentIndices+n.length>=this.buffers[this.currentBufferIndex].indexCapacity||this.buffers[this.currentBufferIndex].currentVertices+t.length>=this.buffers[this.currentBufferIndex].vertexCapacity)&&this.changeBuffer(),this.addIndices(n),this.addVertices(t)}update(){this.buffers[this.currentBufferIndex].fill(),this.buffers[this.currentBufferIndex].updateBufferData(this.gl)}render(t){lt(t,{modelMatrix:this.transform.getMatrix()});for(let n=0;n<=this.currentBufferIndex;n++)Le(this.gl,t,this.buffers[n].bufferInfo),ke(this.gl,this.buffers[n].bufferInfo,this.gl.TRIANGLES,this.buffers[n].currentIndices)}reset(){this.currentBufferIndex=0;for(const t of this.buffers)t.resetCount()}addBuffer(){this.currentBufferIndex++,this.buffers.push(new mt(this.gl,{numVertices:this.bufferSize}))}changeBuffer(){this.buffers[this.currentBufferIndex].fill(),this.buffers[this.currentBufferIndex].updateBufferData(this.gl),this.buffers.length<=this.currentBufferIndex+1?this.addBuffer():this.currentBufferIndex++}addVertex(t){this.buffers[this.currentBufferIndex].addVertex(t)}addIndices(t){this.buffers[this.currentBufferIndex].addIndex(t)}addVertices(t){for(let n=0;n<t.length;n++)this.addVertex(t[n])}}function Zi(e,t,n){return new F(e,t,n)}function Ye(e,t,n,r=255){return new F(e,t,n,r)}class F{r;g;b;a;static WHITE=new F(255,255,255);static BLACK=new F(0,0,0);static RED=new F(255,0,0);static GREEN=new F(0,255,0);static BLUE=new F(0,0,255);static YELLOW=new F(255,255,0);static MAGENTA=new F(255,0,255);static CYAN=new F(0,255,255);static TRANSPARENT=new F(0,0,0,0);constructor(t,n,r,i=255){this.r=t,this.g=n,this.b=r,this.a=i}array(){return[this.r,this.g,this.b,this.a]}static toHex(t){return"#"+(1<<24|t.r<<16|t.g<<8|t.b).toString(16).slice(1)}static fromHex(t,n=255){const r=parseInt(t.slice(1),16),i=r>>16&255,s=r>>8&255,o=r&255;return Ye(i,s,o,n)}static interpolate(t,n,r){return new F(Z(r,0,1,t.r,n.r),Z(r,0,1,t.g,n.g),Z(r,0,1,t.b,n.b),Z(r,0,1,t.a,n.a))}}var Wt=(e=>(e[e.Fill=0]="Fill",e[e.Stroke=1]="Stroke",e))(Wt||{});class qe{canvas;ctx;renderer;currentFont="Arial";currentFontSize=32;constructor(t,n){this.renderer=t,this.canvas=n.canvas,this.ctx=this.canvas.getContext("2d")}clear(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}setFontFace(t){this.currentFont=t,this.ctx.font=`${this.currentFontSize}px ${t}`}setFontSize(t){this.currentFontSize=t,this.ctx.font=`${t}px ${this.currentFont}`}setLineWidth(t){this.ctx.lineWidth=t}setTextAlign(t){this.ctx.textAlign=t}setLetterSpacing(t){this.ctx.letterSpacing=t}setWordSpacing(t){this.ctx.wordSpacing=t}renderText(t,n,r,i=0){const s=this.renderer.camera.worldSpaceToScreenSpace(n).add(this.renderer.transform.translation);this.ctx.save(),this.ctx.translate(s.x,s.y),this.ctx.rotate(this.renderer.transform.rotation),this.ctx.scale(this.renderer.transform.scaling.x*this.renderer.camera.zoom,this.renderer.transform.scaling.y*this.renderer.camera.zoom),i===0?(this.ctx.fillStyle=`rgba(${r.r}, ${r.g}, ${r.b}, ${r.a})`,this.ctx.fillText(t,0,0)):(this.ctx.strokeStyle=`rgba(${r.r}, ${r.g}, ${r.b}, ${r.a})`,this.ctx.strokeText(t,0,0)),this.ctx.fillStyle="red",this.ctx.restore()}getTextMetrics(t){const n=this.ctx.measureText(t);return console.log(n.actualBoundingBoxDescent),{width:n.actualBoundingBoxRight+n.actualBoundingBoxLeft,height:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent,deltaY:n.actualBoundingBoxDescent}}}class Ht{static canvas;static ctx;static camera;static enabled=!1;static init(t){this.canvas=t.canvas,this.ctx=this.canvas.getContext("2d"),this.camera=t.camera,this.enabled=!0}static clear(){this.enabled&&this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}static debugLine(t,n="red"){if(!this.enabled)return;const r=0,i=(-t.c-t.a*r)/t.b,s=this.ctx.canvas.width,o=(-t.c-t.a*s)/t.b,c=this.camera.worldSpaceToScreenSpace(new x(r,i)),a=this.camera.worldSpaceToScreenSpace(new x(s,o));this.ctx.strokeStyle=n,this.ctx.beginPath(),this.ctx.moveTo(c.x,c.y),this.ctx.lineTo(a.x,a.y),this.ctx.stroke()}static debugPoint(t,n="red"){if(!this.enabled)return;this.ctx.fillStyle=n;const r=this.camera.worldSpaceToScreenSpace(t);this.ctx.beginPath(),this.ctx.arc(r.x,r.y,5,0,Math.PI*2),this.ctx.fill()}}class Ji{canvas;gl;transform;camera;textRenderer;vertexColor=new F(255,255,255,255);shaderProgramInfo;buffers=[];currentBufferIndex=0;currentPath=[];constructor(t){t.canvas?this.canvas=t.canvas:(this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,document.body.appendChild(this.canvas));let n=null;if((t.webglVersion===2||!t.webglVersion)&&(n=this.canvas.getContext("webgl2"),n||console.warn("WebGL 2 not supported, falling back to WebGL 1")),(!n||t.webglVersion===1)&&(n=this.canvas.getContext("webgl")),!n)throw new Error("WebGL not supported");if(this.gl=n,t.initTextRenderer){const r=document.createElement("canvas");r.width=window.innerWidth,r.height=window.innerHeight,this.canvas.parentElement.appendChild(r),r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.pointerEvents="none",this.textRenderer=new qe(this,{canvas:r})}else this.textRenderer=null;if(t.camera?(this.camera=t.camera,this.camera.setDisplaySize(new x(this.canvas.width,this.canvas.height))):this.camera=new We(new x(this.canvas.width,this.canvas.height)),this.shaderProgramInfo=qi(this.gl,[Oe.vertexShader,Oe.fragmentShader]),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE),Xi(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.setBuffer(new He(this.gl,{bufferSize:1e3})),this.transform=new nt,t.enableDebugRenderer){const r=document.createElement("canvas");r.width=window.innerWidth,r.height=window.innerHeight,this.canvas.parentElement.appendChild(r),r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.pointerEvents="none",Ht.init({canvas:r,camera:this.camera})}}resizeCanvas(t,n){this.canvas.width=t,this.canvas.height=n,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}setBuffer(t){if(t===0){this.currentBufferIndex=0;return}t.id===-1&&(t.id=this.buffers.length,this.buffers.push(t)),this.currentBufferIndex=t.id}enableBlending(t){t?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND)}setBlendMode(t){switch(t){case 0:this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);break;case 1:this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE);break}}clear(t=new F(0,0,0,255)){this.gl.clearColor(t.r/255,t.g/255,t.b/255,t.a/255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.textRenderer&&this.textRenderer.clear(),Ht.clear()}buildPath(t,n,r=!1,i){const s=[],o=[],c=t[0],a=t[1];t.length===2&&(r=!1);let u=!1,h=!1;if(!r)s.push(...$t(c,a,n));else{const f=Ge(t[t.length-1],c,a,n,i);s.push(...f.vertices),s.length===3&&(o.push(0,1,2),u=!0,h=f.right)}for(let f=0;f<t.length-(r?1:2);f++){const l=Ge(t[f],t[f+1],t[(f+2)%t.length],n,i);o.push(...l.indices.map(y=>y+s.length-2)),s.push(...l.vertices)}if(!r)o.push(...[0,1,2,1,2,3].map(f=>f+s.length-2)),s.push(...$t(t[t.length-1],t[t.length-2],n).reverse());else{const f=s.length-2;u?h?o.push(f,f+1,2,f,0,2):o.push(f,f+1,0,f,0,1):o.push(f,f+1,1,f,0,1)}this.buffers[this.currentBufferIndex].addVerticesAndIndices(this.transform.transformVertices(s),o)}buildDashedPath(t,n,r=!1,i=10,s){let o=null;const c=r?t.length+1:t.length;for(let a=0;a<c;a++){const u=t[a%t.length],h=t[(a+1)%t.length],f=u.pos.dist(h.pos),l=Math.floor(f/i),y=f/l;let p=t[a];const T=h.pos.copy().sub(u.pos);for(let S=1;S<l;S++){const b=u.pos.copy().add(T.copy().setMag(y*S));let A=new E(b,F.interpolate(u.color,h.color,S/l));if(S===1&&o&&(this.buildPath([o,u,A],n,r,s),a===c-1))break;S%2===0&&this.buildPath([p,A],n,r,s),p=A}o=p}}setColor(t){this.vertexColor=t}beginPath(){this.currentPath=[]}vertex(t,n){t instanceof E?this.currentPath.push(t):n?this.currentPath.push(new E(t,n)):this.currentPath.push(new E(t,this.vertexColor))}vertices(t,n){t[0]instanceof E?this.currentPath=[...this.currentPath,...t]:n?this.currentPath=[...this.currentPath,...t.map(r=>new E(r,n))]:this.currentPath=[...this.currentPath,...t.map(r=>new E(r,this.vertexColor))]}splitPath(){this.currentPath.push(null)}line(t,n){const r=new E(t,this.vertexColor),i=new E(n,this.vertexColor);this.currentPath.push(r,i,null)}arc(t,n,r,i,s=1){const o=30*s,c=(i-r)/o,a=[];let u=0;for(let h=0;h<=o;h++)u=r+c*h,a.push(new E(new x(t.x+n*Math.cos(u),t.y+n*Math.sin(u)),this.vertexColor));i-u>.01&&a.push(new E(new x(t.x+n*Math.cos(i),t.y+n*Math.sin(i)),this.vertexColor)),this.currentPath.push(...a)}rect(t,n){const r=[t,new x(t.x+n.x,t.y),new x(t.x+n.x,t.y+n.y),new x(t.x,t.y+n.y)];this.currentPath.push(...r.map(i=>new E(i,this.vertexColor)))}stroke(t,{closed:n=!1,dashed:r=!1,dashLength:i=10,miterLimit:s=60}={}){let o=this.currentPath.findIndex(c=>c===null);if(o===-1){r?this.buildDashedPath(this.currentPath,t,n,i,s):this.buildPath(this.currentPath,t,n,s);return}for(;o!==-1;){if(r?this.buildDashedPath(this.currentPath.slice(0,o),t,n,i,s):this.buildPath(this.currentPath.slice(0,o),t,n,s),this.currentPath=this.currentPath.slice(o+1),this.currentPath.length===0)return;o=this.currentPath.findIndex(c=>c===null),o=o===-1?this.currentPath.length:o}}fill(){let t=this.currentPath.findIndex(n=>n===null);if(this.currentPath=this.currentPath.slice(t+1),t=this.currentPath.findIndex(n=>n===null),t===-1){this.fillPath(this.currentPath);return}for(;t!==-1;){if(this.fillPath(this.currentPath.slice(0,t)),this.currentPath=this.currentPath.slice(t+1),this.currentPath.length===0)return;t=this.currentPath.findIndex(n=>n===null),t=t===-1?this.currentPath.length:t}}fillPath(t){const n=[];for(let r=1;r<t.length-1;r++)n.push(0,r,r+1);this.buffers[this.currentBufferIndex].addVerticesAndIndices(this.transform.transformVertices(t),n)}setFontFace(t){if(!this.textRenderer)throw new Error("Text renderer not initialized!");this.textRenderer.setFontFace(t)}setFontSize(t){this.textRenderer&&this.textRenderer.setFontSize(t)}setTextAlign(t){if(!this.textRenderer)throw new Error("Text renderer not initialized!");this.textRenderer.setTextAlign(t)}setLetterSpacing(t){if(!this.textRenderer)throw new Error("Text renderer not initialized!");this.textRenderer.setLetterSpacing(t)}setWordSpacing(t){if(!this.textRenderer)throw new Error("Text renderer not initialized!");this.textRenderer.setWordSpacing(t)}fillText(t,n){if(!this.textRenderer)throw new Error("Text renderer not initialized!");this.textRenderer.renderText(t,n,this.vertexColor,Wt.Fill)}strokeText(t,n,r=1){if(!this.textRenderer)throw new Error("Text renderer not initialized!");this.textRenderer.setLineWidth(r),this.textRenderer.renderText(t,n,this.vertexColor,Wt.Stroke)}getTextMetrics(t){if(!this.textRenderer)throw new Error("Text renderer not initialized!");return this.textRenderer.getTextMetrics(t)}render(){this.buffers[0].update();const t={resolution:[this.gl.canvas.width,this.gl.canvas.height],viewProjectionMatrix:this.camera.getMatrix()};this.gl.useProgram(this.shaderProgramInfo.program),lt(this.shaderProgramInfo,t);for(const n of this.buffers)n.render(this.shaderProgramInfo);this.buffers[0].reset()}translate(t,n=0){this.transform.translate(t instanceof x?t:new x(t,n))}rotate(t){this.transform.rotate(t)}scale(t,n){this.transform.scale(t instanceof x?t:new x(t,n||t))}resetTransforms(){this.transform.resetTransforms()}getDisplaySize(){return new x(this.canvas.width,this.canvas.height)}}class Qi extends Gt{buffer;tempVertices=[];tempIndices=[];constructor(t){super(t),this.buffer=null}addVerticesAndIndices(t,n){this.tempVertices.push(...t),this.tempIndices.push(...n)}update(){if(this.buffer){if(this.tempVertices.length>this.buffer.vertexCapacity||this.tempIndices.length>this.buffer.indexCapacity){for(const t of Object.values(this.buffer.bufferInfo.attribs))this.gl.deleteBuffer(t.buffer);this.gl.deleteBuffer(this.buffer.bufferInfo.indices),this.buffer=new mt(this.gl,{numVertices:this.tempVertices.length,numIndices:this.tempIndices.length,type:"static"})}else this.buffer.resetCount();this.buffer.addIndex(this.tempIndices);for(const t of this.tempVertices)this.buffer.addVertex(t);this.buffer.updateBufferData(this.gl)}else{this.buffer=new mt(this.gl,{numVertices:this.tempVertices.length,numIndices:this.tempIndices.length,type:"static"}),this.buffer.addIndex(this.tempIndices);for(const t of this.tempVertices)this.buffer.addVertex(t);this.buffer.updateBufferData(this.gl)}this.tempIndices=[],this.tempVertices=[]}render(t){if(!this.buffer)throw new Error("Buffer not initialized! Run buffer.update()");lt(t,{modelMatrix:this.transform.getMatrix()}),Le(this.gl,t,this.buffer.bufferInfo),ke(this.gl,this.buffer.bufferInfo,this.gl.TRIANGLES,this.buffer.currentIndices)}}_.Buffer=Gt,_.BufferData=mt,_.Camera=We,_.CanvasTextRenderer=qe,_.Color=F,_.DebugRenderer=Ht,_.DynamicBuffer=He,_.RGB=Zi,_.RGBA=Ye,_.Renderer=Ji,_.StaticBuffer=Qi,_.Transform=nt,_.Vec=Ki,_.Vector=x,_.Vertex=E,Object.defineProperty(_,Symbol.toStringTag,{value:"Module"})});
